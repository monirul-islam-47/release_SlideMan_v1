<!DOCTYPE html><html><head>
      <title>CONSOLIDATED_FOUNDERS_BRIEFCASE</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="file:///c:\Users\Gluttony\.windsurf\extensions\shd101wyy.markdown-preview-enhanced-0.8.18-universal\crossnote\dependencies\katex\katex.min.css">
      
      
      <script type="text/javascript" src="file:///c:\Users\Gluttony\.windsurf\extensions\shd101wyy.markdown-preview-enhanced-0.8.18-universal\crossnote\dependencies\mermaid\mermaid.min.js" charset="UTF-8"></script>
      
      
      <style>
      code[class*=language-],pre[class*=language-]{color:#333;background:0 0;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.4;-moz-tab-size:8;-o-tab-size:8;tab-size:8;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:.8em;overflow:auto;border-radius:3px;background:#f5f5f5}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal;background:#f5f5f5}.token.blockquote,.token.comment{color:#969896}.token.cdata{color:#183691}.token.doctype,.token.macro.property,.token.punctuation,.token.variable{color:#333}.token.builtin,.token.important,.token.keyword,.token.operator,.token.rule{color:#a71d5d}.token.attr-value,.token.regex,.token.string,.token.url{color:#183691}.token.atrule,.token.boolean,.token.code,.token.command,.token.constant,.token.entity,.token.number,.token.property,.token.symbol{color:#0086b3}.token.prolog,.token.selector,.token.tag{color:#63a35c}.token.attr-name,.token.class,.token.class-name,.token.function,.token.id,.token.namespace,.token.pseudo-class,.token.pseudo-element,.token.url-reference .token.variable{color:#795da3}.token.entity{cursor:help}.token.title,.token.title .token.punctuation{font-weight:700;color:#1d3e81}.token.list{color:#ed6a43}.token.inserted{background-color:#eaffea;color:#55a532}.token.deleted{background-color:#ffecec;color:#bd2c00}.token.bold{font-weight:700}.token.italic{font-style:italic}.language-json .token.property{color:#183691}.language-markup .token.tag .token.punctuation{color:#333}.language-css .token.function,code.language-css{color:#0086b3}.language-yaml .token.atrule{color:#63a35c}code.language-yaml{color:#183691}.language-ruby .token.function{color:#333}.language-markdown .token.url{color:#795da3}.language-makefile .token.symbol{color:#795da3}.language-makefile .token.variable{color:#183691}.language-makefile .token.builtin{color:#0086b3}.language-bash .token.keyword{color:#0086b3}pre[data-line]{position:relative;padding:1em 0 1em 3em}pre[data-line] .line-highlight-wrapper{position:absolute;top:0;left:0;background-color:transparent;display:block;width:100%}pre[data-line] .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:hsla(24,20%,50%,.08);background:linear-gradient(to right,hsla(24,20%,50%,.1) 70%,hsla(24,20%,50%,0));pointer-events:none;line-height:inherit;white-space:pre}pre[data-line] .line-highlight:before,pre[data-line] .line-highlight[data-end]:after{content:attr(data-start);position:absolute;top:.4em;left:.6em;min-width:1em;padding:0 .5em;background-color:hsla(24,20%,50%,.4);color:#f4f1ef;font:bold 65%/1.5 sans-serif;text-align:center;vertical-align:.3em;border-radius:999px;text-shadow:none;box-shadow:0 1px #fff}pre[data-line] .line-highlight[data-end]:after{content:attr(data-end);top:auto;bottom:.4em}html body{font-family:'Helvetica Neue',Helvetica,'Segoe UI',Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ol,html body>ul{margin-bottom:16px}html body ol,html body ul{padding-left:2em}html body ol.no-list,html body ul.no-list{padding:0;list-style-type:none}html body ol ol,html body ol ul,html body ul ol,html body ul ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:700;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::after,html body code::before{letter-spacing:-.2em;content:'\00a0'}html body pre>code{padding:0;margin:0;word-break:normal;white-space:pre;background:0 0;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:after,html body pre code:before,html body pre tt:after,html body pre tt:before{content:normal}html body blockquote,html body dl,html body ol,html body p,html body pre,html body ul{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body code,html body pre{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview ul{list-style:disc}.markdown-preview ul ul{list-style:circle}.markdown-preview ul ul ul{list-style:square}.markdown-preview ol{list-style:decimal}.markdown-preview ol ol,.markdown-preview ul ol{list-style-type:lower-roman}.markdown-preview ol ol ol,.markdown-preview ol ul ol,.markdown-preview ul ol ol,.markdown-preview ul ul ol{list-style-type:lower-alpha}.markdown-preview .newpage,.markdown-preview .pagebreak{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center!important}.markdown-preview:not([data-for=preview]) .code-chunk .code-chunk-btn-group{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .status{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .output-div{margin-bottom:16px}.markdown-preview .md-toc{padding:0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link div,.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}.markdown-preview .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0;min-height:100vh}@media screen and (min-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{font-size:14px!important;padding:1em}}@media print{html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc{padding:0 16px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link div,html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% - 300px);padding:2em calc(50% - 457px - 300px / 2);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
      <!-- The content below will be included at the end of the <head> element. --><script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function () {
    // your code here
  });
</script></head><body for="html-export">
    
    
      <div class="crossnote markdown-preview  ">
      
<h1 id="prezi-comprehensive-founders-briefcase---consolidated-knowledge-base">PrezI: Comprehensive Founders Briefcase - Consolidated Knowledge Base </h1>
<p><em>Consolidated from 13 source documents on June 8, 2025</em><br>
<em>Version: 2.0 - Complete Master Reference</em><br>
<em>Status: Verified Complete - All Source Content Integrated</em></p>
<hr>
<h2 id="table-of-contents">Table of Contents </h2>
<ol>
<li><a href="#1-executive-summary--vision">Executive Summary &amp; Vision</a></li>
<li><a href="#2-technical-architecture">Technical Architecture</a></li>
<li><a href="#3-ai-intelligence-design">AI Intelligence Design</a></li>
<li><a href="#4-user-experience-design">User Experience Design</a></li>
<li><a href="#5-development--operations-guide">Development &amp; Operations Guide</a></li>
<li><a href="#6-technical-implementation-guide">Technical Implementation Guide</a></li>
<li><a href="#7-complete-uiux-specifications">Complete UI/UX Specifications</a></li>
<li><a href="#8-operations-manual">Operations Manual</a></li>
<li><a href="#9-enhancement-roadmap">Enhancement Roadmap</a></li>
<li><a href="#10-quick-reference">Quick Reference</a></li>
</ol>
<hr>
<h2 id="1-executive-summary--vision">1. Executive Summary &amp; Vision </h2>
<h3 id="11-the-problem-presentation-purgatory">1.1 The Problem: Presentation Purgatory </h3>
<p>Every day, millions of professionals waste 4-5 hours searching through dozens of PowerPoint files, hunting for that perfect slide. They copy-paste slides into new decks, creating visual Frankenstein monsters with clashing fonts, inconsistent colors, and misaligned logos. This is a <strong>$50 billion drain on productivity</strong>.</p>
<h3 id="12-the-solution-prezi">1.2 The Solution: PrezI </h3>
<p><strong>PrezI is an intelligent manager for your entire slide universe.</strong> She understands the content inside every slide, learns your style, maintains your brand, and helps you craft compelling stories from your best work—in minutes, not hours.</p>
<h3 id="13-core-value-proposition">1.3 Core Value Proposition </h3>
<p>Transform the chaos into a clear, searchable library and turn your intent into a professional presentation:</p>
<blockquote>
<p><strong>"I need a pitch for the BigCorp investors. Focus on our Q4 results and our growth strategy for 2025."</strong></p>
</blockquote>
<p>PrezI responds with a step-by-step plan, executes automatically, and delivers a professional, branded presentation ready for the boardroom.</p>
<h3 id="14-complete-feature-set">1.4 Complete Feature Set </h3>
<h4 id="slideman-the-professional-workspace">SlideMan: The Professional Workspace </h4>
<ul>
<li><strong>Project &amp; File Management</strong>: Create projects, bulk import <code>.pptx</code> files, unified slide library</li>
<li><strong>Interactive Organization</strong>: Manual slide tagging, element-level tagging, keyword management, live filtering</li>
<li><strong>Manual Assembly</strong>: Click-to-assemble, drag-and-drop reordering, clear assembly</li>
<li><strong>Export &amp; Output</strong>: Export to <code>.pptx</code>/<code>.pdf</code>, custom naming, auto-launch</li>
</ul>
<h4 id="prezi-the-ai-partner">PrezI: The AI Partner </h4>
<ul>
<li><strong>Content Intelligence</strong>: Automated slide analysis, auto-tagging, keyword suggestions</li>
<li><strong>AI-Driven Search</strong>: Natural language search, global cross-project search</li>
<li><strong>Automated Creation</strong>: Intent-to-plan conversion, automated assembly execution</li>
<li><strong>Professional Polish</strong>: Style harmonization, consistent branding</li>
<li><strong>Proactive Partnership</strong>: Contextual suggestions, user-friendly error handling</li>
</ul>
<h4 id="user-experience--platform">User Experience &amp; Platform </h4>
<ul>
<li><strong>First-Time Experience</strong>: Welcome screens, API key setup, guided tours, personalized completion</li>
<li><strong>Platform Support</strong>: Windows-first with COM automation, cross-platform roadmap</li>
<li><strong>Security &amp; Configuration</strong>: OS-native credential storage, user-friendly settings, robust logging</li>
</ul>
<hr>
<h2 id="2-technical-architecture">2. Technical Architecture </h2>
<h3 id="21-architectural-vision-best-of-both-worlds-hybrid">2.1 Architectural Vision: "Best of Both Worlds" Hybrid </h3>
<ul>
<li><strong>Native Power</strong>: Unrestricted local file access, direct PowerPoint COM integration</li>
<li><strong>Web-First Experience</strong>: Fluid, beautiful UI matching high-fidelity mockups</li>
</ul>
<h3 id="22-system-architecture">2.2 System Architecture </h3>
<pre data-role="codeBlock" data-info="" class="language-text"><code>┌─────────────────────────────────────────────────────────────────┐
│                        USER'S COMPUTER                         │
│                                                                 │
│ ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│ │ Electron Shell  │  │ PowerPoint/COM  │  │    OpenAI API   │ │
│ │   (Wrapper)     │  │   (Automation)  │  │   (Intelligence)│ │
│ └─────────────────┘  └─────────────────┘  └─────────────────┘ │
│ │                                                             │ │
│ │ ┌─────────────────────────────────────────────────────────┐ │ │
│ │ │              Frontend UI (The Cockpit)                  │ │ │
│ │ │                HTML, CSS, JavaScript                    │ │ │
│ │ └─────────────────────────────────────────────────────────┘ │ │
│ │                           ↕ HTTP/WebSocket                 │ │
│ │ ┌─────────────────────────────────────────────────────────┐ │ │
│ │ │            Python Backend (The Engine)                  │ │ │
│ │ │        FastAPI + Core Services + Database               │ │ │
│ │ └─────────────────────────────────────────────────────────┘ │ │
│ └─────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
</code></pre><h3 id="23-technology-stack">2.3 Technology Stack </h3>
<table>
<thead>
<tr>
<th>Layer</th>
<th>Technology</th>
<th>Rationale</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Desktop Wrapper</strong></td>
<td>Electron</td>
<td>Cross-platform, mature, excellent community support</td>
</tr>
<tr>
<td><strong>UI Frontend</strong></td>
<td>HTML5, CSS3, JavaScript</td>
<td>Guarantees exact mockup look and feel</td>
</tr>
<tr>
<td><strong>Communication</strong></td>
<td>FastAPI (Python)</td>
<td>High-performance, async-native, auto-documentation</td>
</tr>
<tr>
<td><strong>Backend Engine</strong></td>
<td>Python 3.10+</td>
<td>Robust AI libraries, SQLite support, matches PoC</td>
</tr>
<tr>
<td><strong>Database</strong></td>
<td>SQLite + FTS5</td>
<td>Serverless, zero-config, perfect for local-first</td>
</tr>
<tr>
<td><strong>AI Services</strong></td>
<td>OpenAI API (GPT-4o, o3)</td>
<td>State-of-the-art NLP and reasoning</td>
</tr>
<tr>
<td><strong>Office Integration</strong></td>
<td>pywin32 (COM)</td>
<td>Standard for direct Microsoft Office control</td>
</tr>
</tbody>
</table>
<h3 id="24-project-structure">2.4 Project Structure </h3>
<pre data-role="codeBlock" data-info="" class="language-text"><code>prezi_app/
├── main.js                 # Electron entry point
├── package.json           # Node.js dependencies
├── docs/                  # Complete planning documents
├── backend/               # Python Engine
│   ├── main.py           # FastAPI server entry
│   ├── api/v1/           # API endpoints
│   ├── core/             # Business logic services
│   ├── database/         # Database management
│   └── tests/            # Backend tests
└── frontend/             # Web UI
    ├── index.html        # Single page application
    ├── styles/           # CSS files
    ├── scripts/          # JavaScript modules
    └── assets/           # Static resources
</code></pre><h3 id="25-database-schema-sqlite">2.5 Database Schema (SQLite) </h3>
<p><strong>Core Tables:</strong></p>
<ul>
<li><code>projects</code>: Project metadata and organization</li>
<li><code>files</code>: Imported PowerPoint file tracking</li>
<li><code>slides</code>: Individual slide content and analysis</li>
<li><code>elements</code>: Slide element detection and tagging</li>
<li><code>keywords</code>: Tag management and organization</li>
<li><code>assemblies</code>: Presentation assembly state</li>
</ul>
<p><strong>Advanced Features:</strong></p>
<ul>
<li><code>slides_fts</code>: Full-text search using FTS5</li>
<li><code>onboarding_state</code>: First-time user experience tracking</li>
<li><code>user_settings</code>: Application configuration</li>
<li><code>api_credentials</code>: Secure OpenAI key management</li>
</ul>
<p><strong>Complete Database Schema (SQLite + FTS5):</strong></p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token comment">-- Core Structure Tables</span>
<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> <span class="token keyword keyword-IF">IF</span> <span class="token operator">NOT</span> <span class="token keyword keyword-EXISTS">EXISTS</span> projects <span class="token punctuation">(</span>
    project_id      <span class="token keyword keyword-INTEGER">INTEGER</span> <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">,</span>
    name            <span class="token keyword keyword-TEXT">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword keyword-UNIQUE">UNIQUE</span><span class="token punctuation">,</span>
    root_path       <span class="token keyword keyword-TEXT">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    created_at      <span class="token keyword keyword-DATETIME">DATETIME</span> <span class="token keyword keyword-DEFAULT">DEFAULT</span> <span class="token keyword keyword-CURRENT_TIMESTAMP">CURRENT_TIMESTAMP</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> <span class="token keyword keyword-IF">IF</span> <span class="token operator">NOT</span> <span class="token keyword keyword-EXISTS">EXISTS</span> files <span class="token punctuation">(</span>
    file_id         <span class="token keyword keyword-INTEGER">INTEGER</span> <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">,</span>
    project_id      <span class="token keyword keyword-INTEGER">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    original_path   <span class="token keyword keyword-TEXT">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    sanitized_path  <span class="token keyword keyword-TEXT">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    slide_count     <span class="token keyword keyword-INTEGER">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    imported_at     <span class="token keyword keyword-DATETIME">DATETIME</span> <span class="token keyword keyword-DEFAULT">DEFAULT</span> <span class="token keyword keyword-CURRENT_TIMESTAMP">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span>
    <span class="token keyword keyword-FOREIGN">FOREIGN</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">(</span>project_id<span class="token punctuation">)</span> <span class="token keyword keyword-REFERENCES">REFERENCES</span> projects<span class="token punctuation">(</span>project_id<span class="token punctuation">)</span> <span class="token keyword keyword-ON">ON</span> <span class="token keyword keyword-DELETE">DELETE</span> <span class="token keyword keyword-CASCADE">CASCADE</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> <span class="token keyword keyword-IF">IF</span> <span class="token operator">NOT</span> <span class="token keyword keyword-EXISTS">EXISTS</span> slides <span class="token punctuation">(</span>
    slide_id            <span class="token keyword keyword-INTEGER">INTEGER</span> <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">,</span>
    file_id             <span class="token keyword keyword-INTEGER">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    slide_number_in_file <span class="token keyword keyword-INTEGER">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    title_text          <span class="token keyword keyword-TEXT">TEXT</span><span class="token punctuation">,</span>
    body_text           <span class="token keyword keyword-TEXT">TEXT</span><span class="token punctuation">,</span>
    speaker_notes       <span class="token keyword keyword-TEXT">TEXT</span><span class="token punctuation">,</span>
    thumbnail_path      <span class="token keyword keyword-TEXT">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    ai_topic            <span class="token keyword keyword-TEXT">TEXT</span><span class="token punctuation">,</span>
    ai_type             <span class="token keyword keyword-TEXT">TEXT</span><span class="token punctuation">,</span>
    ai_insight          <span class="token keyword keyword-TEXT">TEXT</span><span class="token punctuation">,</span>
    created_at          <span class="token keyword keyword-DATETIME">DATETIME</span> <span class="token keyword keyword-DEFAULT">DEFAULT</span> <span class="token keyword keyword-CURRENT_TIMESTAMP">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span>
    <span class="token keyword keyword-FOREIGN">FOREIGN</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">(</span>file_id<span class="token punctuation">)</span> <span class="token keyword keyword-REFERENCES">REFERENCES</span> files<span class="token punctuation">(</span>file_id<span class="token punctuation">)</span> <span class="token keyword keyword-ON">ON</span> <span class="token keyword keyword-DELETE">DELETE</span> <span class="token keyword keyword-CASCADE">CASCADE</span><span class="token punctuation">,</span>
    <span class="token keyword keyword-UNIQUE">UNIQUE</span><span class="token punctuation">(</span>file_id<span class="token punctuation">,</span> slide_number_in_file<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> <span class="token keyword keyword-IF">IF</span> <span class="token operator">NOT</span> <span class="token keyword keyword-EXISTS">EXISTS</span> elements <span class="token punctuation">(</span>
    element_id      <span class="token keyword keyword-INTEGER">INTEGER</span> <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">,</span>
    slide_id        <span class="token keyword keyword-INTEGER">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    element_type    <span class="token keyword keyword-TEXT">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    bounding_box    <span class="token keyword keyword-TEXT">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    extracted_text  <span class="token keyword keyword-TEXT">TEXT</span><span class="token punctuation">,</span>
    created_at      <span class="token keyword keyword-DATETIME">DATETIME</span> <span class="token keyword keyword-DEFAULT">DEFAULT</span> <span class="token keyword keyword-CURRENT_TIMESTAMP">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span>
    <span class="token keyword keyword-FOREIGN">FOREIGN</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">(</span>slide_id<span class="token punctuation">)</span> <span class="token keyword keyword-REFERENCES">REFERENCES</span> slides<span class="token punctuation">(</span>slide_id<span class="token punctuation">)</span> <span class="token keyword keyword-ON">ON</span> <span class="token keyword keyword-DELETE">DELETE</span> <span class="token keyword keyword-CASCADE">CASCADE</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- Keyword &amp; Linking Tables</span>
<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> <span class="token keyword keyword-IF">IF</span> <span class="token operator">NOT</span> <span class="token keyword keyword-EXISTS">EXISTS</span> keywords <span class="token punctuation">(</span>
    keyword_id      <span class="token keyword keyword-INTEGER">INTEGER</span> <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">,</span>
    project_id      <span class="token keyword keyword-INTEGER">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token keyword keyword-text">text</span>            <span class="token keyword keyword-TEXT">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    color_hex       <span class="token keyword keyword-TEXT">TEXT</span> <span class="token keyword keyword-DEFAULT">DEFAULT</span> <span class="token string">'#e5e7eb'</span><span class="token punctuation">,</span>
    created_at      <span class="token keyword keyword-DATETIME">DATETIME</span> <span class="token keyword keyword-DEFAULT">DEFAULT</span> <span class="token keyword keyword-CURRENT_TIMESTAMP">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span>
    <span class="token keyword keyword-FOREIGN">FOREIGN</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">(</span>project_id<span class="token punctuation">)</span> <span class="token keyword keyword-REFERENCES">REFERENCES</span> projects<span class="token punctuation">(</span>project_id<span class="token punctuation">)</span> <span class="token keyword keyword-ON">ON</span> <span class="token keyword keyword-DELETE">DELETE</span> <span class="token keyword keyword-CASCADE">CASCADE</span><span class="token punctuation">,</span>
    <span class="token keyword keyword-UNIQUE">UNIQUE</span><span class="token punctuation">(</span>project_id<span class="token punctuation">,</span> <span class="token keyword keyword-text">text</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> <span class="token keyword keyword-IF">IF</span> <span class="token operator">NOT</span> <span class="token keyword keyword-EXISTS">EXISTS</span> slide_keywords <span class="token punctuation">(</span>
    slide_id        <span class="token keyword keyword-INTEGER">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    keyword_id      <span class="token keyword keyword-INTEGER">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">(</span>slide_id<span class="token punctuation">,</span> keyword_id<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword keyword-FOREIGN">FOREIGN</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">(</span>slide_id<span class="token punctuation">)</span> <span class="token keyword keyword-REFERENCES">REFERENCES</span> slides<span class="token punctuation">(</span>slide_id<span class="token punctuation">)</span> <span class="token keyword keyword-ON">ON</span> <span class="token keyword keyword-DELETE">DELETE</span> <span class="token keyword keyword-CASCADE">CASCADE</span><span class="token punctuation">,</span>
    <span class="token keyword keyword-FOREIGN">FOREIGN</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">(</span>keyword_id<span class="token punctuation">)</span> <span class="token keyword keyword-REFERENCES">REFERENCES</span> keywords<span class="token punctuation">(</span>keyword_id<span class="token punctuation">)</span> <span class="token keyword keyword-ON">ON</span> <span class="token keyword keyword-DELETE">DELETE</span> <span class="token keyword keyword-CASCADE">CASCADE</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> <span class="token keyword keyword-IF">IF</span> <span class="token operator">NOT</span> <span class="token keyword keyword-EXISTS">EXISTS</span> element_keywords <span class="token punctuation">(</span>
    element_id      <span class="token keyword keyword-INTEGER">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    keyword_id      <span class="token keyword keyword-INTEGER">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">(</span>element_id<span class="token punctuation">,</span> keyword_id<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword keyword-FOREIGN">FOREIGN</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">(</span>element_id<span class="token punctuation">)</span> <span class="token keyword keyword-REFERENCES">REFERENCES</span> elements<span class="token punctuation">(</span>element_id<span class="token punctuation">)</span> <span class="token keyword keyword-ON">ON</span> <span class="token keyword keyword-DELETE">DELETE</span> <span class="token keyword keyword-CASCADE">CASCADE</span><span class="token punctuation">,</span>
    <span class="token keyword keyword-FOREIGN">FOREIGN</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">(</span>keyword_id<span class="token punctuation">)</span> <span class="token keyword keyword-REFERENCES">REFERENCES</span> keywords<span class="token punctuation">(</span>keyword_id<span class="token punctuation">)</span> <span class="token keyword keyword-ON">ON</span> <span class="token keyword keyword-DELETE">DELETE</span> <span class="token keyword keyword-CASCADE">CASCADE</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- Assembly Tables</span>
<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> <span class="token keyword keyword-IF">IF</span> <span class="token operator">NOT</span> <span class="token keyword keyword-EXISTS">EXISTS</span> assemblies <span class="token punctuation">(</span>
    assembly_id     <span class="token keyword keyword-INTEGER">INTEGER</span> <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">,</span>
    project_id      <span class="token keyword keyword-INTEGER">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    name            <span class="token keyword keyword-TEXT">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    created_at      <span class="token keyword keyword-DATETIME">DATETIME</span> <span class="token keyword keyword-DEFAULT">DEFAULT</span> <span class="token keyword keyword-CURRENT_TIMESTAMP">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span>
    <span class="token keyword keyword-FOREIGN">FOREIGN</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">(</span>project_id<span class="token punctuation">)</span> <span class="token keyword keyword-REFERENCES">REFERENCES</span> projects<span class="token punctuation">(</span>project_id<span class="token punctuation">)</span> <span class="token keyword keyword-ON">ON</span> <span class="token keyword keyword-DELETE">DELETE</span> <span class="token keyword keyword-CASCADE">CASCADE</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> <span class="token keyword keyword-IF">IF</span> <span class="token operator">NOT</span> <span class="token keyword keyword-EXISTS">EXISTS</span> assembly_slides <span class="token punctuation">(</span>
    assembly_slide_id   <span class="token keyword keyword-INTEGER">INTEGER</span> <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">,</span>
    assembly_id         <span class="token keyword keyword-INTEGER">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    slide_id            <span class="token keyword keyword-INTEGER">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    slide_order         <span class="token keyword keyword-INTEGER">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token keyword keyword-FOREIGN">FOREIGN</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">(</span>assembly_id<span class="token punctuation">)</span> <span class="token keyword keyword-REFERENCES">REFERENCES</span> assemblies<span class="token punctuation">(</span>assembly_id<span class="token punctuation">)</span> <span class="token keyword keyword-ON">ON</span> <span class="token keyword keyword-DELETE">DELETE</span> <span class="token keyword keyword-CASCADE">CASCADE</span><span class="token punctuation">,</span>
    <span class="token keyword keyword-FOREIGN">FOREIGN</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">(</span>slide_id<span class="token punctuation">)</span> <span class="token keyword keyword-REFERENCES">REFERENCES</span> slides<span class="token punctuation">(</span>slide_id<span class="token punctuation">)</span> <span class="token keyword keyword-ON">ON</span> <span class="token keyword keyword-DELETE">DELETE</span> <span class="token keyword keyword-CASCADE">CASCADE</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- Full-Text Search (FTS5)</span>
<span class="token keyword keyword-CREATE">CREATE</span> VIRTUAL <span class="token keyword keyword-TABLE">TABLE</span> <span class="token keyword keyword-IF">IF</span> <span class="token operator">NOT</span> <span class="token keyword keyword-EXISTS">EXISTS</span> slides_fts <span class="token keyword keyword-USING">USING</span> fts5<span class="token punctuation">(</span>
    title_text<span class="token punctuation">,</span> body_text<span class="token punctuation">,</span> speaker_notes<span class="token punctuation">,</span> ai_topic<span class="token punctuation">,</span> ai_insight<span class="token punctuation">,</span>
    content<span class="token operator">=</span><span class="token string">'slides'</span><span class="token punctuation">,</span> content_rowid<span class="token operator">=</span><span class="token string">'slide_id'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- FTS5 Sync Triggers</span>
<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TRIGGER">TRIGGER</span> <span class="token keyword keyword-IF">IF</span> <span class="token operator">NOT</span> <span class="token keyword keyword-EXISTS">EXISTS</span> slides_after_insert <span class="token keyword keyword-AFTER">AFTER</span> <span class="token keyword keyword-INSERT">INSERT</span> <span class="token keyword keyword-ON">ON</span> slides <span class="token keyword keyword-BEGIN">BEGIN</span>
  <span class="token keyword keyword-INSERT">INSERT</span> <span class="token keyword keyword-INTO">INTO</span> slides_fts<span class="token punctuation">(</span>rowid<span class="token punctuation">,</span> title_text<span class="token punctuation">,</span> body_text<span class="token punctuation">,</span> speaker_notes<span class="token punctuation">,</span> ai_topic<span class="token punctuation">,</span> ai_insight<span class="token punctuation">)</span>
  <span class="token keyword keyword-VALUES">VALUES</span> <span class="token punctuation">(</span>new<span class="token punctuation">.</span>slide_id<span class="token punctuation">,</span> new<span class="token punctuation">.</span>title_text<span class="token punctuation">,</span> new<span class="token punctuation">.</span>body_text<span class="token punctuation">,</span> new<span class="token punctuation">.</span>speaker_notes<span class="token punctuation">,</span> new<span class="token punctuation">.</span>ai_topic<span class="token punctuation">,</span> new<span class="token punctuation">.</span>ai_insight<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword keyword-END">END</span><span class="token punctuation">;</span>

<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TRIGGER">TRIGGER</span> <span class="token keyword keyword-IF">IF</span> <span class="token operator">NOT</span> <span class="token keyword keyword-EXISTS">EXISTS</span> slides_after_delete <span class="token keyword keyword-AFTER">AFTER</span> <span class="token keyword keyword-DELETE">DELETE</span> <span class="token keyword keyword-ON">ON</span> slides <span class="token keyword keyword-BEGIN">BEGIN</span>
  <span class="token keyword keyword-INSERT">INSERT</span> <span class="token keyword keyword-INTO">INTO</span> slides_fts<span class="token punctuation">(</span>slides_fts<span class="token punctuation">,</span> rowid<span class="token punctuation">,</span> title_text<span class="token punctuation">,</span> body_text<span class="token punctuation">,</span> speaker_notes<span class="token punctuation">,</span> ai_topic<span class="token punctuation">,</span> ai_insight<span class="token punctuation">)</span>
  <span class="token keyword keyword-VALUES">VALUES</span> <span class="token punctuation">(</span><span class="token string">'delete'</span><span class="token punctuation">,</span> old<span class="token punctuation">.</span>slide_id<span class="token punctuation">,</span> old<span class="token punctuation">.</span>title_text<span class="token punctuation">,</span> old<span class="token punctuation">.</span>body_text<span class="token punctuation">,</span> old<span class="token punctuation">.</span>speaker_notes<span class="token punctuation">,</span> old<span class="token punctuation">.</span>ai_topic<span class="token punctuation">,</span> old<span class="token punctuation">.</span>ai_insight<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword keyword-END">END</span><span class="token punctuation">;</span>

<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TRIGGER">TRIGGER</span> <span class="token keyword keyword-IF">IF</span> <span class="token operator">NOT</span> <span class="token keyword keyword-EXISTS">EXISTS</span> slides_after_update <span class="token keyword keyword-AFTER">AFTER</span> <span class="token keyword keyword-UPDATE">UPDATE</span> <span class="token keyword keyword-ON">ON</span> slides <span class="token keyword keyword-BEGIN">BEGIN</span>
  <span class="token keyword keyword-INSERT">INSERT</span> <span class="token keyword keyword-INTO">INTO</span> slides_fts<span class="token punctuation">(</span>slides_fts<span class="token punctuation">,</span> rowid<span class="token punctuation">,</span> title_text<span class="token punctuation">,</span> body_text<span class="token punctuation">,</span> speaker_notes<span class="token punctuation">,</span> ai_topic<span class="token punctuation">,</span> ai_insight<span class="token punctuation">)</span>
  <span class="token keyword keyword-VALUES">VALUES</span> <span class="token punctuation">(</span><span class="token string">'delete'</span><span class="token punctuation">,</span> old<span class="token punctuation">.</span>slide_id<span class="token punctuation">,</span> old<span class="token punctuation">.</span>title_text<span class="token punctuation">,</span> old<span class="token punctuation">.</span>body_text<span class="token punctuation">,</span> old<span class="token punctuation">.</span>speaker_notes<span class="token punctuation">,</span> old<span class="token punctuation">.</span>ai_topic<span class="token punctuation">,</span> old<span class="token punctuation">.</span>ai_insight<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword keyword-INSERT">INSERT</span> <span class="token keyword keyword-INTO">INTO</span> slides_fts<span class="token punctuation">(</span>rowid<span class="token punctuation">,</span> title_text<span class="token punctuation">,</span> body_text<span class="token punctuation">,</span> speaker_notes<span class="token punctuation">,</span> ai_topic<span class="token punctuation">,</span> ai_insight<span class="token punctuation">)</span>
  <span class="token keyword keyword-VALUES">VALUES</span> <span class="token punctuation">(</span>new<span class="token punctuation">.</span>slide_id<span class="token punctuation">,</span> new<span class="token punctuation">.</span>title_text<span class="token punctuation">,</span> new<span class="token punctuation">.</span>body_text<span class="token punctuation">,</span> new<span class="token punctuation">.</span>speaker_notes<span class="token punctuation">,</span> new<span class="token punctuation">.</span>ai_topic<span class="token punctuation">,</span> new<span class="token punctuation">.</span>ai_insight<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword keyword-END">END</span><span class="token punctuation">;</span>

<span class="token comment">-- User Experience &amp; Onboarding Tables</span>
<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> <span class="token keyword keyword-IF">IF</span> <span class="token operator">NOT</span> <span class="token keyword keyword-EXISTS">EXISTS</span> user_settings <span class="token punctuation">(</span>
    setting_id      <span class="token keyword keyword-INTEGER">INTEGER</span> <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">,</span>
    setting_key     <span class="token keyword keyword-TEXT">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword keyword-UNIQUE">UNIQUE</span><span class="token punctuation">,</span>
    setting_value   <span class="token keyword keyword-TEXT">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    updated_at      <span class="token keyword keyword-DATETIME">DATETIME</span> <span class="token keyword keyword-DEFAULT">DEFAULT</span> <span class="token keyword keyword-CURRENT_TIMESTAMP">CURRENT_TIMESTAMP</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> <span class="token keyword keyword-IF">IF</span> <span class="token operator">NOT</span> <span class="token keyword keyword-EXISTS">EXISTS</span> api_credentials <span class="token punctuation">(</span>
    credential_id       <span class="token keyword keyword-INTEGER">INTEGER</span> <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">,</span>
    service_name        <span class="token keyword keyword-TEXT">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword keyword-UNIQUE">UNIQUE</span><span class="token punctuation">,</span>
    credential_status   <span class="token keyword keyword-TEXT">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    last_validated      <span class="token keyword keyword-DATETIME">DATETIME</span><span class="token punctuation">,</span>
    models_available    <span class="token keyword keyword-TEXT">TEXT</span><span class="token punctuation">,</span>
    updated_at          <span class="token keyword keyword-DATETIME">DATETIME</span> <span class="token keyword keyword-DEFAULT">DEFAULT</span> <span class="token keyword keyword-CURRENT_TIMESTAMP">CURRENT_TIMESTAMP</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> <span class="token keyword keyword-IF">IF</span> <span class="token operator">NOT</span> <span class="token keyword keyword-EXISTS">EXISTS</span> onboarding_state <span class="token punctuation">(</span>
    onboarding_id       <span class="token keyword keyword-INTEGER">INTEGER</span> <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">,</span>
    completed           <span class="token keyword keyword-BOOLEAN">BOOLEAN</span> <span class="token keyword keyword-DEFAULT">DEFAULT</span> <span class="token number">0</span><span class="token punctuation">,</span>
    current_state       <span class="token keyword keyword-TEXT">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword keyword-DEFAULT">DEFAULT</span> <span class="token string">'WELCOME'</span><span class="token punctuation">,</span>
    branch_path         <span class="token keyword keyword-TEXT">TEXT</span><span class="token punctuation">,</span>
    progression         <span class="token keyword keyword-INTEGER">INTEGER</span> <span class="token keyword keyword-DEFAULT">DEFAULT</span> <span class="token number">0</span><span class="token punctuation">,</span>
    started_at          <span class="token keyword keyword-DATETIME">DATETIME</span> <span class="token keyword keyword-DEFAULT">DEFAULT</span> <span class="token keyword keyword-CURRENT_TIMESTAMP">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span>
    completed_at        <span class="token keyword keyword-DATETIME">DATETIME</span><span class="token punctuation">,</span>
    last_updated        <span class="token keyword keyword-DATETIME">DATETIME</span> <span class="token keyword keyword-DEFAULT">DEFAULT</span> <span class="token keyword keyword-CURRENT_TIMESTAMP">CURRENT_TIMESTAMP</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> <span class="token keyword keyword-IF">IF</span> <span class="token operator">NOT</span> <span class="token keyword keyword-EXISTS">EXISTS</span> onboarding_transitions <span class="token punctuation">(</span>
    transition_id       <span class="token keyword keyword-INTEGER">INTEGER</span> <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">,</span>
    onboarding_id       <span class="token keyword keyword-INTEGER">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    from_state          <span class="token keyword keyword-TEXT">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    to_state            <span class="token keyword keyword-TEXT">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    transition_type     <span class="token keyword keyword-TEXT">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    time_spent_ms       <span class="token keyword keyword-INTEGER">INTEGER</span><span class="token punctuation">,</span>
    transition_timestamp <span class="token keyword keyword-DATETIME">DATETIME</span> <span class="token keyword keyword-DEFAULT">DEFAULT</span> <span class="token keyword keyword-CURRENT_TIMESTAMP">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span>
    <span class="token keyword keyword-FOREIGN">FOREIGN</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">(</span>onboarding_id<span class="token punctuation">)</span> <span class="token keyword keyword-REFERENCES">REFERENCES</span> onboarding_state<span class="token punctuation">(</span>onboarding_id<span class="token punctuation">)</span> <span class="token keyword keyword-ON">ON</span> <span class="token keyword keyword-DELETE">DELETE</span> <span class="token keyword keyword-CASCADE">CASCADE</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> <span class="token keyword keyword-IF">IF</span> <span class="token operator">NOT</span> <span class="token keyword keyword-EXISTS">EXISTS</span> onboarding_content <span class="token punctuation">(</span>
    content_id          <span class="token keyword keyword-INTEGER">INTEGER</span> <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">,</span>
    state_name          <span class="token keyword keyword-TEXT">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    branch_path         <span class="token keyword keyword-TEXT">TEXT</span><span class="token punctuation">,</span>
    title               <span class="token keyword keyword-TEXT">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    content_html        <span class="token keyword keyword-TEXT">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    ui_highlights       <span class="token keyword keyword-TEXT">TEXT</span><span class="token punctuation">,</span>
    primary_action      <span class="token keyword keyword-TEXT">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    secondary_actions   <span class="token keyword keyword-TEXT">TEXT</span><span class="token punctuation">,</span>
    version             <span class="token keyword keyword-INTEGER">INTEGER</span> <span class="token keyword keyword-DEFAULT">DEFAULT</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token keyword keyword-UNIQUE">UNIQUE</span><span class="token punctuation">(</span>state_name<span class="token punctuation">,</span> branch_path<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> <span class="token keyword keyword-IF">IF</span> <span class="token operator">NOT</span> <span class="token keyword keyword-EXISTS">EXISTS</span> onboarding_actions <span class="token punctuation">(</span>
    action_id           <span class="token keyword keyword-INTEGER">INTEGER</span> <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">,</span>
    onboarding_id       <span class="token keyword keyword-INTEGER">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    current_state       <span class="token keyword keyword-TEXT">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    action_type         <span class="token keyword keyword-TEXT">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    feature_context     <span class="token keyword keyword-TEXT">TEXT</span><span class="token punctuation">,</span>
    action_data         <span class="token keyword keyword-TEXT">TEXT</span><span class="token punctuation">,</span>
    action_timestamp    <span class="token keyword keyword-DATETIME">DATETIME</span> <span class="token keyword keyword-DEFAULT">DEFAULT</span> <span class="token keyword keyword-CURRENT_TIMESTAMP">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span>
    <span class="token keyword keyword-FOREIGN">FOREIGN</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">(</span>onboarding_id<span class="token punctuation">)</span> <span class="token keyword keyword-REFERENCES">REFERENCES</span> onboarding_state<span class="token punctuation">(</span>onboarding_id<span class="token punctuation">)</span> <span class="token keyword keyword-ON">ON</span> <span class="token keyword keyword-DELETE">DELETE</span> <span class="token keyword keyword-CASCADE">CASCADE</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> <span class="token keyword keyword-IF">IF</span> <span class="token operator">NOT</span> <span class="token keyword keyword-EXISTS">EXISTS</span> onboarding_assistant <span class="token punctuation">(</span>
    interaction_id      <span class="token keyword keyword-INTEGER">INTEGER</span> <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">,</span>
    onboarding_id       <span class="token keyword keyword-INTEGER">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    state_name          <span class="token keyword keyword-TEXT">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    user_query          <span class="token keyword keyword-TEXT">TEXT</span><span class="token punctuation">,</span>
    assistant_response  <span class="token keyword keyword-TEXT">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    feature_context     <span class="token keyword keyword-TEXT">TEXT</span><span class="token punctuation">,</span>
    interaction_timestamp <span class="token keyword keyword-DATETIME">DATETIME</span> <span class="token keyword keyword-DEFAULT">DEFAULT</span> <span class="token keyword keyword-CURRENT_TIMESTAMP">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span>
    <span class="token keyword keyword-FOREIGN">FOREIGN</span> <span class="token keyword keyword-KEY">KEY</span><span class="token punctuation">(</span>onboarding_id<span class="token punctuation">)</span> <span class="token keyword keyword-REFERENCES">REFERENCES</span> onboarding_state<span class="token punctuation">(</span>onboarding_id<span class="token punctuation">)</span> <span class="token keyword keyword-ON">ON</span> <span class="token keyword keyword-DELETE">DELETE</span> <span class="token keyword keyword-CASCADE">CASCADE</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- Performance Indexes</span>
<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-INDEX">INDEX</span> <span class="token keyword keyword-IF">IF</span> <span class="token operator">NOT</span> <span class="token keyword keyword-EXISTS">EXISTS</span> idx_files_project_id <span class="token keyword keyword-ON">ON</span> files<span class="token punctuation">(</span>project_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-INDEX">INDEX</span> <span class="token keyword keyword-IF">IF</span> <span class="token operator">NOT</span> <span class="token keyword keyword-EXISTS">EXISTS</span> idx_slides_file_id <span class="token keyword keyword-ON">ON</span> slides<span class="token punctuation">(</span>file_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-INDEX">INDEX</span> <span class="token keyword keyword-IF">IF</span> <span class="token operator">NOT</span> <span class="token keyword keyword-EXISTS">EXISTS</span> idx_elements_slide_id <span class="token keyword keyword-ON">ON</span> elements<span class="token punctuation">(</span>slide_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-INDEX">INDEX</span> <span class="token keyword keyword-IF">IF</span> <span class="token operator">NOT</span> <span class="token keyword keyword-EXISTS">EXISTS</span> idx_keywords_project_id <span class="token keyword keyword-ON">ON</span> keywords<span class="token punctuation">(</span>project_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-INDEX">INDEX</span> <span class="token keyword keyword-IF">IF</span> <span class="token operator">NOT</span> <span class="token keyword keyword-EXISTS">EXISTS</span> idx_slide_keywords_keyword_id <span class="token keyword keyword-ON">ON</span> slide_keywords<span class="token punctuation">(</span>keyword_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-INDEX">INDEX</span> <span class="token keyword keyword-IF">IF</span> <span class="token operator">NOT</span> <span class="token keyword keyword-EXISTS">EXISTS</span> idx_element_keywords_keyword_id <span class="token keyword keyword-ON">ON</span> element_keywords<span class="token punctuation">(</span>keyword_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-INDEX">INDEX</span> <span class="token keyword keyword-IF">IF</span> <span class="token operator">NOT</span> <span class="token keyword keyword-EXISTS">EXISTS</span> idx_assembly_slides_assembly_id <span class="token keyword keyword-ON">ON</span> assembly_slides<span class="token punctuation">(</span>assembly_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-INDEX">INDEX</span> <span class="token keyword keyword-IF">IF</span> <span class="token operator">NOT</span> <span class="token keyword keyword-EXISTS">EXISTS</span> idx_onboarding_actions_onboarding_id <span class="token keyword keyword-ON">ON</span> onboarding_actions<span class="token punctuation">(</span>onboarding_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-INDEX">INDEX</span> <span class="token keyword keyword-IF">IF</span> <span class="token operator">NOT</span> <span class="token keyword keyword-EXISTS">EXISTS</span> idx_onboarding_actions_state <span class="token keyword keyword-ON">ON</span> onboarding_actions<span class="token punctuation">(</span>current_state<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-INDEX">INDEX</span> <span class="token keyword keyword-IF">IF</span> <span class="token operator">NOT</span> <span class="token keyword keyword-EXISTS">EXISTS</span> idx_onboarding_transitions_onboarding_id <span class="token keyword keyword-ON">ON</span> onboarding_transitions<span class="token punctuation">(</span>onboarding_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-INDEX">INDEX</span> <span class="token keyword keyword-IF">IF</span> <span class="token operator">NOT</span> <span class="token keyword keyword-EXISTS">EXISTS</span> idx_onboarding_assistant_onboarding_id <span class="token keyword keyword-ON">ON</span> onboarding_assistant<span class="token punctuation">(</span>onboarding_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><h3 id="26-api-specification">2.6 API Specification </h3>
<p><strong>Base URL:</strong> <code>http://127.0.0.1:8765/api/v1</code></p>
<p><strong>Core Endpoints:</strong></p>
<ul>
<li><code>POST/GET /projects</code> - Project management</li>
<li><code>POST /projects/{id}/import</code> - File import (async)</li>
<li><code>GET /slides</code> - Slide retrieval with filtering</li>
<li><code>POST /slides/{id}/keywords</code> - Keyword assignment</li>
<li><code>GET/POST/PUT/DELETE /assembly</code> - Assembly management</li>
<li><code>POST /prezi/interpret</code> - AI intent analysis</li>
<li><code>POST /prezi/plan</code> - Visual plan generation</li>
<li><code>POST /prezi/execute</code> - Plan execution (async)</li>
<li><code>POST /export</code> - Presentation export (async)</li>
</ul>
<p><strong>Onboarding API:</strong></p>
<ul>
<li><code>GET/PUT /onboarding/state</code> - State machine management</li>
<li><code>GET /onboarding/content</code> - Dynamic content delivery</li>
<li><code>POST /auth/validate-api-key</code> - API key validation</li>
</ul>
<p><strong>Real-time Communication:</strong></p>
<ul>
<li>WebSocket: <code>ws://127.0.0.1:8765/ws</code></li>
<li>Events: <code>TASK_PROGRESS</code>, <code>PREZI_SUGGESTION</code>, <code>LIBRARY_UPDATED</code></li>
</ul>
<hr>
<h2 id="3-ai-intelligence-design">3. AI Intelligence Design </h2>
<h3 id="31-prezis-cognitive-model-the-ooda-loop">3.1 PrezI's Cognitive Model: The OODA Loop </h3>
<ol>
<li><strong>Observe</strong>: Context awareness (selected slides, command bar input, assembly state)</li>
<li><strong>Orient</strong>: Natural language processing and intent understanding</li>
<li><strong>Decide</strong>: Visual plan formulation with Human-in-the-Loop approval</li>
<li><strong>Act</strong>: Step-by-step execution with real-time feedback</li>
</ol>
<h3 id="32-personality-matrix-the-brilliant-partner">3.2 Personality Matrix: "The Brilliant Partner" </h3>
<table>
<thead>
<tr>
<th>Situation</th>
<th>Tone</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Greeting/Idle</strong></td>
<td>Professional, Ready</td>
<td>"Ready to build something brilliant."</td>
</tr>
<tr>
<td><strong>Receiving Command</strong></td>
<td>Attentive, Focused</td>
<td>"Understood. Analyzing your request for 'investor pitch'..."</td>
</tr>
<tr>
<td><strong>Presenting Plan</strong></td>
<td>Confident, Clear</td>
<td>"Here is my proposed 4-step plan. Review and approve."</td>
</tr>
<tr>
<td><strong>Executing Task</strong></td>
<td>Energetic, Focused</td>
<td>"✨ Finding the best revenue charts now..."</td>
</tr>
<tr>
<td><strong>Task Success</strong></td>
<td>Celebratory, Encouraging</td>
<td>"Done! Your presentation is ready. You're going to impress."</td>
</tr>
<tr>
<td><strong>Error Handling</strong></td>
<td>Analytical, Reassuring</td>
<td>"The API timed out. No worries. Let's try that again."</td>
</tr>
</tbody>
</table>
<h3 id="33-complete-master-prompt-library">3.3 Complete Master Prompt Library </h3>
<h4 id="analyze_slide_content-gpt-4o---content-understanding">ANALYZE_SLIDE_CONTENT (GPT-4o - Content Understanding) </h4>
<p><strong>Goal</strong>: Extract structured metadata from slide text content during import<br>
<strong>Trigger</strong>: For each slide during conversion process<br>
<strong>System Prompt</strong>:</p>
<pre data-role="codeBlock" data-info="" class="language-text"><code>You are a world-class presentation analyst. Your task is to analyze the provided slide content and return a structured JSON object. Be concise and precise.
</code></pre><p><strong>User Prompt</strong>:</p>
<pre data-role="codeBlock" data-info="json" class="language-json json"><code>Analyze the following slide content and return a single<span class="token punctuation">,</span> minified JSON object with no markdown formatting.

Slide Content<span class="token operator">:</span>
<span class="token punctuation">{</span>
  <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"${slide_title}"</span><span class="token punctuation">,</span>
  <span class="token property">"body_text"</span><span class="token operator">:</span> <span class="token string">"${slide_body_text}"</span><span class="token punctuation">,</span>
  <span class="token property">"speaker_notes"</span><span class="token operator">:</span> <span class="token string">"${slide_speaker_notes}"</span>
<span class="token punctuation">}</span>

JSON Schema to follow<span class="token operator">:</span>
<span class="token punctuation">{</span>
  <span class="token property">"slide_topic"</span><span class="token operator">:</span> <span class="token string">"A brief, 3-5 word topic for the slide."</span><span class="token punctuation">,</span>
  <span class="token property">"slide_type"</span><span class="token operator">:</span> <span class="token string">"Categorize as one of: 'Title', 'Agenda', 'Problem', 'Solution', 'Data/Chart', 'Quote', 'Team', 'Summary', 'Call to Action', 'Other'."</span><span class="token punctuation">,</span>
  <span class="token property">"sentiment"</span><span class="token operator">:</span> <span class="token string">"'Positive', 'Negative', or 'Neutral'."</span><span class="token punctuation">,</span>
  <span class="token property">"keywords"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"An array of 5-7 relevant keywords extracted from the content."</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"key_insight"</span><span class="token operator">:</span> <span class="token string">"A single sentence summarizing the main takeaway of the slide."</span>
<span class="token punctuation">}</span>
</code></pre><h4 id="interpret_user_intent-gpt-4o---command-translation">INTERPRET_USER_INTENT (GPT-4o - Command Translation) </h4>
<p><strong>Goal</strong>: Convert natural language commands into structured actionable requests<br>
<strong>Trigger</strong>: When user types in universal command bar<br>
<strong>System Prompt</strong>:</p>
<pre data-role="codeBlock" data-info="" class="language-text"><code>You are an expert system that translates natural language commands into structured JSON. Your task is to understand the user's goal and extract key parameters.
</code></pre><p><strong>User Prompt</strong>:</p>
<pre data-role="codeBlock" data-info="json" class="language-json json"><code>Analyze the user's command and the current application context. Return a single<span class="token punctuation">,</span> minified JSON object representing their intent.

User Command<span class="token operator">:</span> <span class="token string">"${user_command}"</span>

Application Context<span class="token operator">:</span>
<span class="token punctuation">{</span>
  <span class="token property">"available_slide_types"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"Title"</span><span class="token punctuation">,</span> <span class="token string">"Agenda"</span><span class="token punctuation">,</span> <span class="token string">"Problem"</span><span class="token punctuation">,</span> <span class="token string">"Solution"</span><span class="token punctuation">,</span> <span class="token string">"Data/Chart"</span><span class="token punctuation">,</span> <span class="token string">"Quote"</span><span class="token punctuation">,</span> <span class="token string">"Team"</span><span class="token punctuation">,</span> <span class="token string">"Summary"</span><span class="token punctuation">,</span> <span class="token string">"Call to Action"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"available_keywords"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"${keyword_list}"</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

JSON Schema to follow<span class="token operator">:</span>
<span class="token punctuation">{</span>
  <span class="token property">"primary_action"</span><span class="token operator">:</span> <span class="token string">"Categorize the user's main goal. Must be one of: 'FIND', 'CREATE', 'ANALYZE', 'EDIT'."</span><span class="token punctuation">,</span>
  <span class="token property">"search_parameters"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"keywords"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"List of keywords to search for."</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"slide_types"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"List of slide types to include."</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"date_range"</span><span class="token operator">:</span> <span class="token string">"e.g., 'Q4 2024', 'last month', 'null'."</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"creation_parameters"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"presentation_topic"</span><span class="token operator">:</span> <span class="token string">"The topic of the new presentation."</span><span class="token punctuation">,</span>
    <span class="token property">"target_audience"</span><span class="token operator">:</span> <span class="token string">"e.g., 'investors', 'new clients', 'internal team'."</span><span class="token punctuation">,</span>
    <span class="token property">"presentation_length_minutes"</span><span class="token operator">:</span> <span class="token string">"Estimated length in minutes, or null."</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"analysis_target"</span><span class="token operator">:</span> <span class="token string">"The target of the analysis, e.g., 'current_assembly', 'all_slides'."</span>
<span class="token punctuation">}</span>
</code></pre><h4 id="generate_visual_plan-o3---strategic-planning">GENERATE_VISUAL_PLAN (o3 - Strategic Planning) </h4>
<p><strong>Goal</strong>: Create step-by-step execution plan based on interpreted user intent<br>
<strong>Trigger</strong>: After INTERPRET_USER_INTENT succeeds with CREATE or EDIT action<br>
<strong>System Prompt</strong>:</p>
<pre data-role="codeBlock" data-info="" class="language-text"><code>You are a world-class presentation strategist. Given a user's goal, you create a logical, step-by-step plan to build a compelling presentation. Your plans are clear, concise, and instill confidence.
</code></pre><p><strong>User Prompt</strong>:</p>
<pre data-role="codeBlock" data-info="json" class="language-json json"><code>Based on the user's structured intent<span class="token punctuation">,</span> create a step-by-step plan to build their presentation. The plan should be an array of <span class="token string">"step"</span> objects. Each step must have a 'title' and a 'details' field. The plan should not exceed <span class="token number">10</span> steps. Return a single<span class="token punctuation">,</span> minified JSON object.

Structured User Intent<span class="token operator">:</span>
$<span class="token punctuation">{</span>structured_intent_json<span class="token punctuation">}</span>

JSON Schema to follow<span class="token operator">:</span>
<span class="token punctuation">{</span>
  <span class="token property">"plan"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"A short, actionable title for the step (e.g., 'Find Opening Hook')."</span><span class="token punctuation">,</span>
      <span class="token property">"details"</span><span class="token operator">:</span> <span class="token string">"A brief description of what will be done in this step (e.g., 'Searching for high-impact title and agenda slides.')."</span><span class="token punctuation">,</span>
      <span class="token property">"backend_action"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"function_name"</span><span class="token operator">:</span> <span class="token string">"Name of the Python function to call for this step (e.g., 'find_slides_by_type')."</span><span class="token punctuation">,</span>
        <span class="token property">"parameters"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"param1"</span><span class="token operator">:</span> <span class="token string">"value1"</span> <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><h4 id="onboarding_assistant-gpt-4o---personalized-guidance">ONBOARDING_ASSISTANT (GPT-4o - Personalized Guidance) </h4>
<p><strong>Goal</strong>: Provide conversational guidance through first-time user experience<br>
<strong>Trigger</strong>: During onboarding flow or when explicitly requested<br>
<strong>System Prompt</strong>:</p>
<pre data-role="codeBlock" data-info="" class="language-text"><code>You are PrezI's helpful onboarding assistant. Your goal is to introduce the user to PrezI's core features in under five minutes, explaining each concept briefly and clearly. Be encouraging and cheerful, but respect the user's time. Guide them through the current onboarding step, focusing on making them successful quickly.
</code></pre><p><strong>User Prompt</strong>:</p>
<pre data-role="codeBlock" data-info="json" class="language-json json"><code>Generate a brief<span class="token punctuation">,</span> conversational guidance message for the current onboarding step. Keep it under <span class="token number">60</span> words. Be specific to the current feature being demonstrated.

Current Step<span class="token operator">:</span> <span class="token string">"${current_onboarding_step}"</span>
Feature Context<span class="token operator">:</span> <span class="token string">"${feature_description}"</span>
User Actions So Far<span class="token operator">:</span> $<span class="token punctuation">{</span>user_actions_json<span class="token punctuation">}</span>

Response should include<span class="token operator">:</span>
<span class="token number">1</span>. A warm<span class="token punctuation">,</span> brief greeting (if this is the first step)
<span class="token number">2</span>. A clear<span class="token punctuation">,</span> direct explanation of the current feature
<span class="token number">3</span>. A specific instruction on what to do next
</code></pre><h4 id="confidence-threshold-decision-logic">Confidence Threshold Decision Logic </h4>
<pre data-role="codeBlock" data-info="python" class="language-python python"><code><span class="token comment"># Pseudocode for slide selection with confidence scoring</span>
<span class="token keyword keyword-def">def</span> <span class="token function">select_best_slide</span><span class="token punctuation">(</span>slides<span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword keyword-for">for</span> slide <span class="token keyword keyword-in">in</span> slides<span class="token punctuation">:</span>
        slide<span class="token punctuation">.</span>score <span class="token operator">=</span> calculate_relevance_score<span class="token punctuation">(</span>slide<span class="token punctuation">,</span> context<span class="token punctuation">)</span>
    
    sorted_slides <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>slides<span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token keyword keyword-lambda">lambda</span> s<span class="token punctuation">:</span> s<span class="token punctuation">.</span>score<span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    best_slide <span class="token operator">=</span> sorted_slides<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    
    <span class="token keyword keyword-if">if</span> best_slide<span class="token punctuation">.</span>score <span class="token operator">&lt;</span> <span class="token number">0.75</span><span class="token punctuation">:</span>  <span class="token comment"># Confidence Threshold</span>
        <span class="token comment"># If not confident, ask for clarification</span>
        prezi_ask_clarification<span class="token punctuation">(</span>
            <span class="token string">"I found a few options, but none seem perfect. Which of these is closest to what you need?"</span><span class="token punctuation">,</span> 
            options<span class="token operator">=</span>sorted_slides<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span>
        <span class="token punctuation">)</span>
    <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span>
        <span class="token comment"># If confident, proceed</span>
        assembly<span class="token punctuation">.</span>add_slide<span class="token punctuation">(</span>best_slide<span class="token punctuation">)</span>
</code></pre><h3 id="34-onboarding-state-machine">3.4 Onboarding State Machine </h3>
<p><strong>States:</strong> WELCOME → API_SETUP → BRANCH_CHOICE → [FEATURE_TOUR | IMPORT_FIRST] → COMMAND_BAR → ASSEMBLY_PANEL → AI_ASSISTANT → GRADUATION → COMPLETED</p>
<p><strong>Branching Paths:</strong></p>
<ul>
<li><strong>Feature-First</strong>: Showcases capabilities before hands-on usage</li>
<li><strong>Import-First</strong>: Immediate hands-on approach for practical users</li>
</ul>
<p><strong>Analytics Tracking:</strong></p>
<ul>
<li>Completion rates, time-to-value, drop-off points</li>
<li>User action patterns for personalized assistance</li>
<li>Difficulty signals for continuous improvement</li>
</ul>
<hr>
<h2 id="4-user-experience-design">4. User Experience Design </h2>
<h3 id="41-design-philosophy-living-workspace">4.1 Design Philosophy: "Living Workspace" </h3>
<ul>
<li><strong>Clarity in Darkness</strong>: Dark theme makes colorful slides the hero</li>
<li><strong>Fluid &amp; Responsive</strong>: Smooth 60fps animations and immediate feedback</li>
<li><strong>Professionalism with Personality</strong>: Clean aesthetic with signature purple/blue gradients</li>
<li><strong>Content-First Focus</strong>: Tools remain hidden until needed</li>
<li><strong>Immersive &amp; Focused</strong>: Minimal UI chrome, maximum content space</li>
</ul>
<h3 id="42-color-palette">4.2 Color Palette </h3>
<p><strong>Primary Colors:</strong></p>
<ul>
<li>Background: <code>#0a0a0a</code> (deep focus)</li>
<li>Panel: <code>#1a1a1a</code> (containers)</li>
<li>Cards: <code>#2a2a2a</code> (interactive elements)</li>
<li>Borders: <code>#3a3a3a</code> (dividers)</li>
</ul>
<p><strong>Text Hierarchy:</strong></p>
<ul>
<li>Primary: <code>#ffffff</code> (titles)</li>
<li>Secondary: <code>#e5e7eb</code> (descriptions)</li>
<li>Muted: <code>#9ca3af</code> (metadata)</li>
</ul>
<p><strong>Brand Gradients:</strong></p>
<ul>
<li>Primary: <code>linear-gradient(135deg, #667eea, #764ba2)</code></li>
<li>Purple Accent: <code>#a855f7</code></li>
<li>Blue Accent: <code>#3b82f6</code></li>
</ul>
<p><strong>State Colors:</strong></p>
<ul>
<li>Success: <code>#10b981</code></li>
<li>Warning: <code>#f59e0b</code></li>
<li>Error: <code>#ef4444</code></li>
</ul>
<h3 id="43-typography">4.3 Typography </h3>
<ul>
<li><strong>Font Stack</strong>: <code>-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif</code></li>
<li><strong>Scale</strong>: 48px (Display) → 36px (Section) → 24px (Subsection) → 20px (Small Title) → 16px (Body) → 14px (Secondary) → 12px (Caption)</li>
<li><strong>Grid System</strong>: 8px base unit for consistent spacing</li>
</ul>
<h3 id="44-key-ui-components">4.4 Key UI Components </h3>
<p><strong>Buttons:</strong></p>
<ul>
<li>Primary CTA: Gradient background with shadow and hover lift</li>
<li>Secondary: Transparent with border, hover highlight</li>
<li>States: Smooth transitions with cubic-bezier easing</li>
</ul>
<p><strong>Cards:</strong></p>
<ul>
<li>Slide cards: Rounded corners, hover lift animation</li>
<li>Keyword pills: Rounded, subtle hover slide</li>
<li>Selection: 2px colored border for active states</li>
</ul>
<p><strong>Command Bar:</strong></p>
<ul>
<li>Central interaction point with focus ring</li>
<li>Placeholder text cycling through example queries</li>
<li>Real-time search result filtering</li>
</ul>
<p><strong>PrezI Avatar:</strong></p>
<ul>
<li>Gradient core with floating animation</li>
<li>Morphing inner "soul" shape</li>
<li>Particle effects during AI thinking states</li>
</ul>
<h3 id="45-user-flow-diagrams">4.5 User Flow Diagrams </h3>
<p><strong>First-Time Setup:</strong><br>
Start → Empty State → Create Project → Import Files → Progress → Populated Library → Help Tips</p>
<p><strong>Core Workflow Loop:</strong><br>
Search Command → Filter Results → Drag to Assembly → Update Count → Export Options → Progress → Success</p>
<p><strong>AI Magic Moment:</strong><br>
Intent Command → Visual Plan Modal → User Approval → Execution Progress → Real-time Assembly → Celebration</p>
<h3 id="46-screen-specifications">4.6 Screen Specifications </h3>
<p><strong>Main Workspace Layout:</strong></p>
<ul>
<li>Header: 72px with logo, command bar, status</li>
<li>Left Sidebar: 280px (keywords, project info)</li>
<li>Right Sidebar: 320px (assembly panel)</li>
<li>Main Content: Responsive grid of slide cards</li>
</ul>
<p><strong>Modal Behaviors:</strong></p>
<ul>
<li>Fade in with scale-up animation (0.3s)</li>
<li>Backdrop blur for focus</li>
<li>Clear primary actions with visual hierarchy</li>
</ul>
<p><strong>Progress Indicators:</strong></p>
<ul>
<li>Non-intrusive for background tasks</li>
<li>Prominent modal for primary AI actions</li>
<li>Step-by-step visual feedback</li>
</ul>
<hr>
<h2 id="5-development--operations-guide">5. Development &amp; Operations Guide </h2>
<h3 id="51-development-philosophy">5.1 Development Philosophy </h3>
<ul>
<li><strong>Document-Driven</strong>: All specs are single source of truth</li>
<li><strong>Incremental &amp; Verifiable</strong>: Testable sprints with clear deliverables</li>
<li><strong>Component-Based</strong>: Modular, reusable architecture</li>
<li><strong>Quality Paramount</strong>: Comprehensive Definition of Done</li>
<li><strong>Explicit State</strong>: All project state in committed code and docs</li>
</ul>
<h3 id="52-agent-handover-protocol">5.2 Agent Handover Protocol </h3>
<p><strong>End-of-Session Procedure:</strong></p>
<ol>
<li><strong>Commit Code</strong>: Follow semantic commit format with task IDs</li>
<li><strong>Run All Tests</strong>: Execute complete test suite and document results</li>
<li><strong>Update Master Plan</strong>: Mark completed tasks with checkmarks</li>
<li><strong>Generate Handover Note</strong>: Structured summary for next session</li>
</ol>
<p><strong>Start-of-Session Procedure:</strong></p>
<ol>
<li><strong>Verify Environment</strong>: Ensure dependencies are installed</li>
<li><strong>Review Key Documents</strong>: Current plan, handover notes, relevant specs</li>
<li><strong>Run All Tests</strong>: Verify clean starting state</li>
<li><strong>Acknowledge Status</strong>: Confirm understanding of current progress</li>
<li><strong>Proceed with Next Task</strong>: Begin next unchecked item</li>
</ol>
<h3 id="53-phased-development-plan">5.3 Phased Development Plan </h3>
<p><strong>Phase 1: Functional Core (MVP)</strong></p>
<ul>
<li>Sprint 0: Foundation &amp; setup (Electron + FastAPI bridge)</li>
<li>Sprint 1: Database &amp; models (SQLite schema implementation)</li>
<li>Sprint 2: File import &amp; processing (COM automation)</li>
<li>Sprint 3: Slide library UI (responsive grid, filtering)</li>
<li>Sprint 4: Manual tagging &amp; search (keyword management)</li>
<li>Sprint 5: Assembly &amp; export (drag-drop, PowerPoint generation)</li>
<li>Sprint 6: Onboarding experience (state machine, guided tour)</li>
</ul>
<p><strong>Phase 2: Intelligent Assistant</strong></p>
<ul>
<li>PrezI core integration (OpenAI API connection)</li>
<li>AI-powered semantic search</li>
<li>Proactive suggestions &amp; auto-tagging</li>
</ul>
<p><strong>Phase 3: Automated Partner</strong></p>
<ul>
<li>Visual plan workflow</li>
<li>Automated presentation engine</li>
<li>Style harmonization magic</li>
</ul>
<h3 id="54-testing-strategy-testing-pyramid">5.4 Testing Strategy (Testing Pyramid) </h3>
<p><strong>Unit Tests (Foundation):</strong></p>
<ul>
<li>Backend: <code>pytest</code> for all Python functions</li>
<li>Frontend: <code>Jest</code> for JavaScript modules</li>
</ul>
<p><strong>Integration Tests (Mid-level):</strong></p>
<ul>
<li>API endpoint testing with real data</li>
<li>Database operation validation</li>
<li>Cross-component interaction verification</li>
</ul>
<p><strong>End-to-End Tests (Peak):</strong></p>
<ul>
<li>Playwright automation for complete user workflows</li>
<li>Full import → search → assemble → export cycles</li>
<li>AI interaction and response validation</li>
</ul>
<h3 id="55-definition-of-done">5.5 Definition of Done </h3>
<ol>
<li><strong>Code Complete</strong>: Adheres to best practices</li>
<li><strong>Functionality Met</strong>: Works per PRD specifications</li>
<li><strong>Design Adherence</strong>: Pixel-perfect UI implementation</li>
<li><strong>API Contract Fulfilled</strong>: Matches specification exactly</li>
<li><strong>Database Integrity</strong>: Correct schema compliance</li>
<li><strong>AI Logic Implemented</strong>: Follows AIDD rules and prompts</li>
<li><strong>Testing Passed</strong>: 100% test success rate</li>
<li><strong>No Regressions</strong>: Existing features remain functional</li>
</ol>
<h3 id="56-configuration-management">5.6 Configuration Management </h3>
<p><strong>API Key Security:</strong></p>
<ul>
<li>OS-native credential store (Windows Credential Manager)</li>
<li>Never stored in plaintext files</li>
<li>Immediate validation with user feedback</li>
<li>Secure rotation capabilities</li>
</ul>
<p><strong>Application Settings:</strong></p>
<ul>
<li>Default project directory configuration</li>
<li>PrezI personality style selection</li>
<li>Cache management and troubleshooting tools</li>
<li>Export format preferences</li>
</ul>
<h3 id="57-logging--diagnostics">5.7 Logging &amp; Diagnostics </h3>
<p><strong>Log Structure:</strong></p>
<ul>
<li>JSON format for easy parsing</li>
<li>7-day rotation in user AppData directory</li>
<li>INFO level by default with configurable levels</li>
</ul>
<p><strong>Key Events Logged:</strong></p>
<ul>
<li>Application lifecycle (start/shutdown)</li>
<li>Project operations (create/load)</li>
<li>Import/export processes</li>
<li>OpenAI API interactions (masked keys)</li>
<li>Error conditions and exceptions</li>
</ul>
<h3 id="58-error-handling-dictionary">5.8 Error Handling Dictionary </h3>
<table>
<thead>
<tr>
<th>Error Code</th>
<th>User Message</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>INVALID_API_KEY</code></td>
<td>"It seems my API key isn't quite right. Could you please double-check it in Settings?"</td>
</tr>
<tr>
<td><code>API_RATE_LIMIT</code></td>
<td>"Looks like we're thinking too fast! Let's try again in a few moments."</td>
</tr>
<tr>
<td><code>COM_AUTOMATION_FAILURE</code></td>
<td>"I can't communicate with PowerPoint. Please ensure it's installed correctly."</td>
</tr>
<tr>
<td><code>FILE_IMPORT_FAILED</code></td>
<td>"I had trouble with <code>[filename]</code>. It might be corrupted. Shall I skip it?"</td>
</tr>
<tr>
<td><code>NO_SEARCH_RESULTS</code></td>
<td>"Couldn't find anything matching <code>[query]</code>. Try different keywords?"</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="6-technical-implementation-guide">6. Technical Implementation Guide </h2>
<h3 id="61-agent-handover-protocol-critical-for-project-continuity">6.1 Agent Handover Protocol (Critical for Project Continuity) </h3>
<h4 id="end-of-session-procedure-the-commit--handover">End-of-Session Procedure: "The Commit &amp; Handover" </h4>
<p>Before ending any work session, the current AI agent <strong>must</strong> perform these steps:</p>
<ol>
<li>
<p><strong>Commit Code</strong>: All newly created or modified files must be committed to version control</p>
<ul>
<li>Format: <code>feat(scope): Description (Task X.Y)</code> for new features</li>
<li>Format: <code>fix(scope): Description (Task X.Y)</code> for bug fixes</li>
<li>Example: <code>feat(api): Implement GET /slides endpoint (Task 3.1)</code></li>
</ul>
</li>
<li>
<p><strong>Run All Tests</strong>: Execute the entire test suite and paste summary output</p>
<ul>
<li>Proof that new code is correct and no regressions introduced</li>
<li>Work is not complete if any test fails</li>
</ul>
</li>
<li>
<p><strong>Update Master Plan</strong>: Edit the Development &amp; Testing Plan document</p>
<ul>
<li>Place checkmark (<code>✅</code>) next to completed Task ID(s)</li>
<li>Update status and verification notes</li>
</ul>
</li>
<li>
<p><strong>Generate Handover Note</strong>: Conclude session with structured note:</p>
<pre data-role="codeBlock" data-info="" class="language-text"><code>---
**HANDOVER NOTE**
**Session Summary:** Brief one-sentence summary of work accomplished
**Last Task Completed:** Task X.Y - [Task Description]
**Verification:** All tests passed successfully [Link to results]
**Next Task:** Task X.Z - [Task Description]
**Notes &amp; Challenges:** [Important context for next agent]
---
</code></pre></li>
</ol>
<h4 id="start-of-session-procedure-the-wake-up--onboard">Start-of-Session Procedure: "The Wake-Up &amp; Onboard" </h4>
<p>To begin a new work session, any new AI agent <strong>must</strong> perform these steps:</p>
<ol>
<li>
<p><strong>Verify Environment</strong>: Ensure development environment is correctly set up</p>
<ul>
<li>Run <code>pip install -r requirements.txt</code> for backend dependencies</li>
<li>Verify all required tools are available</li>
</ul>
</li>
<li>
<p><strong>Review Key Documents</strong> in this specific order:</p>
<ul>
<li>This Development &amp; Testing Plan (current progress state)</li>
<li>Handover Note from previous agent's session</li>
<li>Specific design/spec documents relevant to next assigned task</li>
</ul>
</li>
<li>
<p><strong>Run All Tests</strong>: Execute entire test suite to verify clean, working state</p>
<ul>
<li>Builds trust in previous agent's work</li>
<li>Identifies any environmental issues</li>
</ul>
</li>
<li>
<p><strong>Acknowledge Current State</strong>: Begin work with confirmation statement</p>
<ul>
<li>Example: "I have successfully onboarded. Last completed task was 3.1. All tests passing. Beginning work on Task 3.2: Implement UI for Main Content Area."</li>
</ul>
</li>
<li>
<p><strong>Proceed with Next Task</strong>: Begin development on next unchecked task</p>
</li>
</ol>
<h3 id="62-detailed-sprint-breakdown-with-task-ids">6.2 Detailed Sprint Breakdown with Task IDs </h3>
<h4 id="sprint-0-project-foundation--environment-setup">Sprint 0: Project Foundation &amp; Environment Setup </h4>
<table>
<thead>
<tr>
<th>Task ID</th>
<th>Description</th>
<th>Key Documents</th>
<th>Status</th>
</tr>
</thead>
<tbody>
<tr>
<td>☐ <strong>0.1</strong></td>
<td>Initialize project directory with frontend/backend structure</td>
<td>SAD, Project Layout</td>
<td></td>
</tr>
<tr>
<td>☐ <strong>0.2</strong></td>
<td>Set up Electron project, configure main.js for main window</td>
<td>SAD</td>
<td></td>
</tr>
<tr>
<td>☐ <strong>0.3</strong></td>
<td>Configure main window to load frontend/index.html on startup</td>
<td>SAD, Design System</td>
<td></td>
</tr>
<tr>
<td>☐ <strong>0.4</strong></td>
<td>Implement Python backend launcher in Electron (start/terminate)</td>
<td>SAD</td>
<td></td>
</tr>
<tr>
<td>☐ <strong>0.5</strong></td>
<td>Establish WebSocket communication bridge with "connected" test</td>
<td>SAD, API Spec</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="sprint-1-database--core-models">Sprint 1: Database &amp; Core Models </h4>
<table>
<thead>
<tr>
<th>Task ID</th>
<th>Description</th>
<th>Key Documents</th>
<th>Status</th>
</tr>
</thead>
<tbody>
<tr>
<td>☐ <strong>1.1</strong></td>
<td>Create SQLite database initialization script</td>
<td>Database Schema</td>
<td></td>
</tr>
<tr>
<td>☐ <strong>1.2</strong></td>
<td>Implement all CREATE TABLE and CREATE INDEX statements</td>
<td>Database Schema</td>
<td></td>
</tr>
<tr>
<td>☐ <strong>1.3</strong></td>
<td>Create database_manager.py with CRUD operations for each table</td>
<td>Database Schema</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="sprint-2-file-import--processing">Sprint 2: File Import &amp; Processing </h4>
<table>
<thead>
<tr>
<th>Task ID</th>
<th>Description</th>
<th>Key Documents</th>
<th>Status</th>
</tr>
</thead>
<tbody>
<tr>
<td>☐ <strong>2.1</strong></td>
<td>Implement POST /projects/{project_id}/import endpoint</td>
<td>API Spec, SAD</td>
<td></td>
</tr>
<tr>
<td>☐ <strong>2.2</strong></td>
<td>Create powerpoint_automator.py with COM automation logic</td>
<td>SAD, PRD</td>
<td></td>
</tr>
<tr>
<td>☐ <strong>2.3</strong></td>
<td>Extract slide thumbnails, title, body, notes to database</td>
<td>Database Schema</td>
<td></td>
</tr>
<tr>
<td>☐ <strong>2.4</strong></td>
<td>Implement real-time TASK_PROGRESS WebSocket updates</td>
<td>API Spec</td>
<td></td>
</tr>
<tr>
<td>☐ <strong>2.5</strong></td>
<td>Create "Import Progress" overlay UI per wireframes</td>
<td>Wireframes, Design System</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="sprint-3-the-slide-library-ui">Sprint 3: The Slide Library UI </h4>
<table>
<thead>
<tr>
<th>Task ID</th>
<th>Description</th>
<th>Key Documents</th>
<th>Status</th>
</tr>
</thead>
<tbody>
<tr>
<td>☐ <strong>3.1</strong></td>
<td>Implement GET /slides endpoint with filtering</td>
<td>API Spec</td>
<td></td>
</tr>
<tr>
<td>☐ <strong>3.2</strong></td>
<td>Create Main Content Area UI with responsive Slide Cards grid</td>
<td>Wireframes, Design System</td>
<td></td>
</tr>
<tr>
<td>☐ <strong>3.3</strong></td>
<td>Connect UI to dynamically fetch/render slides from backend</td>
<td>API Spec, Wireframes</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="sprint-4-manual-tagging--search">Sprint 4: Manual Tagging &amp; Search </h4>
<table>
<thead>
<tr>
<th>Task ID</th>
<th>Description</th>
<th>Key Documents</th>
<th>Status</th>
</tr>
</thead>
<tbody>
<tr>
<td>☐ <strong>4.1</strong></td>
<td>Implement full keywords API (GET/POST/PUT/DELETE)</td>
<td>API Spec, Database Schema</td>
<td></td>
</tr>
<tr>
<td>☐ <strong>4.2</strong></td>
<td>Create Keyword Panel UI with clickable filter pills</td>
<td>Wireframes, Design System</td>
<td></td>
</tr>
<tr>
<td>☐ <strong>4.3</strong></td>
<td>Implement Element Mode UI with bounding box selection</td>
<td>PRD, Wireframes</td>
<td></td>
</tr>
<tr>
<td>☐ <strong>4.4</strong></td>
<td>Connect Command Bar to GET /slides for keyword search</td>
<td>API Spec</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="sprint-5-manual-assembly--export">Sprint 5: Manual Assembly &amp; Export </h4>
<table>
<thead>
<tr>
<th>Task ID</th>
<th>Description</th>
<th>Key Documents</th>
<th>Status</th>
</tr>
</thead>
<tbody>
<tr>
<td>☐ <strong>5.1</strong></td>
<td>Implement full assembly API (GET/POST/PUT/DELETE)</td>
<td>API Spec</td>
<td></td>
</tr>
<tr>
<td>☐ <strong>5.2</strong></td>
<td>Create Assembly Panel UI with drag-and-drop functionality</td>
<td>Wireframes, Design System</td>
<td></td>
</tr>
<tr>
<td>☐ <strong>5.3</strong></td>
<td>Implement POST /export endpoint and PowerPoint generation</td>
<td>API Spec, SAD</td>
<td></td>
</tr>
<tr>
<td>☐ <strong>5.4</strong></td>
<td>Create Export Options and Export Progress UI</td>
<td>Wireframes, Design System</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="sprint-6-first-time-user-experience--onboarding">Sprint 6: First-Time User Experience &amp; Onboarding </h4>
<table>
<thead>
<tr>
<th>Task ID</th>
<th>Description</th>
<th>Key Documents</th>
<th>Status</th>
</tr>
</thead>
<tbody>
<tr>
<td>☐ <strong>6.1</strong></td>
<td>Implement onboarding state machine backend logic</td>
<td>AIDD, Onboarding Handbook</td>
<td></td>
</tr>
<tr>
<td>☐ <strong>6.2</strong></td>
<td>Create onboarding API endpoints (GET/PUT state, content, etc.)</td>
<td>API Spec</td>
<td></td>
</tr>
<tr>
<td>☐ <strong>6.3</strong></td>
<td>Develop welcome screens and onboarding UI flows with animations</td>
<td>UI/UX Design, Onboarding</td>
<td></td>
</tr>
<tr>
<td>☐ <strong>6.4</strong></td>
<td>Implement API key setup &amp; validation UI with secure storage</td>
<td>Onboarding, API Spec</td>
<td></td>
</tr>
<tr>
<td>☐ <strong>6.5</strong></td>
<td>Create onboarding assistant with personalized guidance</td>
<td>AIDD</td>
<td></td>
</tr>
<tr>
<td>☐ <strong>6.6</strong></td>
<td>Implement onboarding action tracking and analytics</td>
<td>DB Schema, Onboarding</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="63-complete-testing-strategy-testing-pyramid">6.3 Complete Testing Strategy (Testing Pyramid) </h3>
<h4 id="unit-tests-foundation-layer">Unit Tests (Foundation Layer) </h4>
<p><strong>Backend (Python):</strong></p>
<ul>
<li><strong>Tool</strong>: <code>pytest</code></li>
<li><strong>Coverage</strong>: Every function in <code>services</code> and <code>managers</code></li>
<li><strong>Examples</strong>:
<ul>
<li><code>test_database_manager.py</code> - tests all CRUD functions</li>
<li><code>test_powerpoint_automator.py</code> - tests COM automation</li>
<li><code>test_prezi_agent.py</code> - tests AI integration</li>
</ul>
</li>
</ul>
<p><strong>Frontend (JavaScript):</strong></p>
<ul>
<li><strong>Tool</strong>: <code>Jest</code></li>
<li><strong>Coverage</strong>: Key JavaScript functions (API callers, state managers)</li>
<li><strong>Examples</strong>:
<ul>
<li><code>test_api.js</code> - tests API communication functions</li>
<li><code>test_ui.js</code> - tests DOM manipulation functions</li>
</ul>
</li>
</ul>
<h4 id="integration-tests-mid-level">Integration Tests (Mid-Level) </h4>
<p><strong>API Tests:</strong></p>
<ul>
<li>Test every single API endpoint defined in API Specification</li>
<li>Verify correct data and status codes returned</li>
<li>Test error conditions and edge cases</li>
</ul>
<p><strong>Database Tests:</strong></p>
<ul>
<li>Complex operations involving multiple tables</li>
<li>Transaction integrity and rollback scenarios</li>
<li>Full-text search functionality</li>
</ul>
<h4 id="end-to-end-tests-peak">End-to-End Tests (Peak) </h4>
<p><strong>Tool</strong>: Playwright (for Electron app automation)<br>
<strong>Example E2E Test Script</strong>: <code>test_create_presentation.js</code></p>
<ol>
<li>Launch PrezI application</li>
<li>Programmatically click "Import Files" button</li>
<li>Simulate file selection</li>
<li>Wait for TASK_PROGRESS WebSocket completion</li>
<li>Verify slide thumbnails appear in UI</li>
<li>Drag three slides to assembly panel</li>
<li>Verify assembly count updates to "3"</li>
<li>Click "Export" and verify success notification</li>
</ol>
<h3 id="64-complete-definition-of-done-8-point-checklist">6.4 Complete Definition of Done (8-Point Checklist) </h3>
<p>A task is only "Done" when it meets <strong>ALL</strong> criteria:</p>
<ol>
<li><strong>Code Complete</strong>: All required code written, adheres to best practices</li>
<li><strong>Functionality Met</strong>: Feature works exactly as described in PRD</li>
<li><strong>Design Adherence</strong>: UI is pixel-perfect per UI/UX Design System and Wireframes</li>
<li><strong>API Contract Fulfilled</strong>: All frontend/backend interactions match API Specification</li>
<li><strong>Database Integrity</strong>: All data stored correctly per Database Schema</li>
<li><strong>AI Logic Implemented</strong>: AI behavior matches rules and prompts in AIDD</li>
<li><strong>Testing Passed</strong>: All relevant unit and integration tests pass 100%</li>
<li><strong>No Regressions</strong>: New code doesn't break existing, completed features</li>
</ol>
<h3 id="65-project-structure-complete-file-organization">6.5 Project Structure (Complete File Organization) </h3>
<pre data-role="codeBlock" data-info="" class="language-text"><code>prezi_app/
├── .gitignore               # Version control ignore patterns
├── package.json             # Node.js dependencies and app scripts
├── main.js                  # Electron application shell entry point
├── 📄 README.md             # Top-level project overview
│
├── 📂 docs/                 # Complete "Founder's Briefcase"
│   ├── 1_Product_Requirements_Document.md
│   ├── 2_System_Architecture_Document.md
│   ├── 3_UI_UX_Design_System.md
│   ├── 4_AI_Design_Document.md
│   ├── 5_API_Specification.md
│   ├── 6_Database_Schema.md
│   ├── 7_Development_and_Testing_Plan.md
│   ├── 8_Operations_and_Experience_Handbook.md
│   └── CONSOLIDATED_FOUNDERS_BRIEFCASE.md
│
├── 📂 backend/              # Python "Engine" - PrezI's brain
│   ├── __init__.py          # Makes 'backend' a Python package
│   ├── main.py              # FastAPI local server entry point
│   ├── requirements.txt     # Python dependencies
│   │
│   ├── 📂 api/              # API endpoint definitions
│   │   ├── __init__.py
│   │   └── v1/
│   │       ├── projects.py    # /projects endpoints
│   │       ├── slides.py      # /slides endpoints  
│   │       ├── prezi.py       # /prezi AI endpoints
│   │       └── onboarding.py  # /onboarding endpoints
│   │
│   ├── 📂 core/             # Core business logic and services
│   │   ├── __init__.py
│   │   ├── powerpoint_automator.py     # Windows COM automation
│   │   ├── prezi_agent.py              # AI intelligence engine
│   │   ├── onboarding_manager.py       # Onboarding state machine
│   │   └── file_system_manager.py      # File operations
│   │
│   ├── 📂 database/         # Database management
│   │   ├── __init__.py
│   │   ├── database_manager.py         # SQLite operations
│   │   └── schema.sql                  # Database creation SQL
│   │
│   └── 📂 tests/            # Backend testing suite
│       ├── __init__.py
│       ├── test_api.py                 # API endpoint tests
│       ├── test_services.py            # Business logic tests
│       └── test_integration.py         # Integration tests
│
└── 📂 frontend/             # Web UI "Cockpit"
    ├── index.html           # Single page application entry
    │
    ├── 📂 assets/           # Static resources
    │   ├── icons/           # UI icons (Phosphor Icons)
    │   └── images/          # Application images
    │
    ├── 📂 styles/           # CSS styling
    │   ├── main.css         # Global styles and CSS variables
    │   └── components/      # Component-specific styles
    │       ├── button.css
    │       ├── card.css
    │       ├── modal.css
    │       └── animation.css
    │
    └── 📂 scripts/          # JavaScript modules
        ├── main.js          # Application logic and event listeners
        ├── api.js           # Backend API communication
        ├── ui.js            # DOM manipulation and UI state
        ├── onboarding.js    # First-time user experience
        └── animations.js    # UI animations and transitions
</code></pre><p><strong>File Placement Rationale:</strong></p>
<ul>
<li><strong>Top-Level Clarity</strong>: Root contains only project-wide config and Electron entry</li>
<li><strong>Strict Separation</strong>: Backend knows nothing about UI; Frontend only knows API</li>
<li><strong>Agent-Friendly</strong>: Unambiguous file locations for AI development agents</li>
<li><strong>Scalability</strong>: Modular structure supports easy feature additions</li>
</ul>
<hr>
<h2 id="7-complete-uiux-specifications">7. Complete UI/UX Specifications </h2>
<h3 id="71-detailed-user-flow-diagrams">7.1 Detailed User Flow Diagrams </h3>
<h4 id="flow-1-first-time-user--initial-project-setup">Flow 1: First-Time User &amp; Initial Project Setup </h4>
<div class="mermaid">graph TD
    A[Start Application] --&gt; B(Display Main Workspace in Empty State)
    B --&gt; C{User Clicks 'Create New Project'}
    C --&gt; D[Show 'New Project' Modal]
    D --&gt; E{User Enters Name &amp; Clicks 'Create'}
    E --&gt; F[Display Main Workspace - Library is Empty]
    F --&gt; G(Show 'Import Your First Presentation' CTA)
    G --&gt; H{User Drags/Drops or Clicks to Import .pptx files}
    H --&gt; I[Show 'Import Progress' Overlay]
    I -- On Success --&gt; J[Hide Overlay, Animate Slides into Library]
    J --&gt; K[Display 'Workflow Help' Tip: "Tag your slides to find them!"]
    I -- On Error --&gt; L[Show 'Import Error' Modal with details]
    L --&gt; F
</div><h4 id="flow-2-search-assemble-and-export-core-loop">Flow 2: Search, Assemble, and Export (Core Loop) </h4>
<div class="mermaid">graph TD
    A[Open Project with Populated Library] --&gt; B{User types in Command Bar}
    B --&gt; C[UI dynamically filters Slide Library Grid]
    C --&gt; D{User drags a slide from Library}
    D --&gt; E[Assembly Panel highlights with 'Drop Zone']
    E --&gt; F{User drops slide into Assembly}
    F --&gt; G[Slide animates into Assembly list]
    G --&gt; H[Assembly count &amp; duration estimate updates]
    H --&gt; B
    H --&gt; I{User clicks 'Export' in Assembly Panel}
    I --&gt; J[Show 'Export Options' Modal]
    J --&gt; K{User confirms export settings}
    K --&gt; L[Show 'Export Progress' Overlay]
    L --&gt; M[On Success, show 'Success!' notification]
    M --&gt; N[Trigger system to open exported .pptx file]
</div><h4 id="flow-3-prezi-powered-creation-the-magic-moment">Flow 3: PrezI-Powered Creation (The "Magic Moment") </h4>
<div class="mermaid">graph TD
    A[User types intent: "Create investor pitch"] --&gt; B[UI sends command to PrezI Engine]
    B --&gt; C[PrezI Engine returns Visual Plan]
    C --&gt; D[Display 'PrezI's Plan' Modal]
    D --&gt; E{User reviews plan and clicks 'Execute Plan'}
    E --&gt; F[Show 'PrezI Execution' Progress Overlay]
    F --&gt; G[Individual steps check off as they complete]
    G --&gt; H[Assembly Panel populates in real-time as PrezI works]
    H --&gt; I{Plan completes}
    I --&gt; J[Display 'Success!' modal with celebratory message from PrezI]
    J --&gt; K[User has fully assembled deck, ready for review or export]
</div><h3 id="72-complete-screen-wireframes">7.2 Complete Screen Wireframes </h3>
<h4 id="main-workspace---empty-state">Main Workspace - Empty State </h4>
<p><strong>When</strong>: First launch or new empty project<br>
<strong>Layout</strong>:</p>
<ul>
<li><strong>Left &amp; Right Panels</strong>: Visible but mostly empty</li>
<li><strong>Main Content Area</strong>:
<ul>
<li>Large friendly icon (+ or folder)</li>
<li><strong>Headline (H3)</strong>: "Let's Build Something Brilliant"</li>
<li><strong>Body Text</strong>: "Import your first PowerPoint files to begin building your slide universe."</li>
<li><strong>Primary CTA Button</strong>: "Import Presentations"</li>
<li><strong>Secondary Text</strong>: "Or drag and drop your files anywhere."</li>
</ul>
</li>
</ul>
<h4 id="main-workspace---loading-state">Main Workspace - Loading State </h4>
<p><strong>When</strong>: During slide import and processing<br>
<strong>Layout</strong>:</p>
<ul>
<li><strong>Main Content Area</strong>: Grid populated with <strong>Skeleton Loader</strong> cards
<ul>
<li>Gray, card-shaped placeholders</li>
<li>Subtle shimmering animation indicating loading</li>
</ul>
</li>
<li><strong>Status Bar</strong>: Clear progress display
<ul>
<li>Example: "⚡️ Processing: <code>Q4_Results.pptx</code> (Slide 32 of 78)..."</li>
</ul>
</li>
</ul>
<h4 id="main-workspace---ideal-state-populated">Main Workspace - Ideal State (Populated) </h4>
<p><strong>When</strong>: Default view with project containing slides<br>
<strong>Layout</strong>:</p>
<ul>
<li><strong>Header (72px)</strong>:
<ul>
<li>Left: App Logo/Name</li>
<li>Center: <strong>Universal Command Bar</strong> (see Component Library)</li>
<li>Right: PrezI Status Indicator, User Profile/Settings icon</li>
</ul>
</li>
<li><strong>Left Sidebar (280px)</strong>:
<ul>
<li>Top: Project Info (Name, slide/file count)</li>
<li>Middle: <strong>Keyword Panel</strong> (clickable Keyword Pills list)</li>
<li>Bottom: Quick Actions (<code>+ Import Files</code>, <code>🏷️ Tag All</code>)</li>
</ul>
</li>
<li><strong>Main Content Area (Slide Library)</strong>:
<ul>
<li>Top: View controls (<code>Grid</code>/<code>List</code>), Sort options</li>
<li>Body: Responsive grid of <strong>Slide Cards</strong> with thumbnails</li>
</ul>
</li>
<li><strong>Right Sidebar (320px, Collapsible)</strong>:
<ul>
<li>Top: <strong>Assembly Panel</strong> with title, slide count, duration</li>
<li>Body: Reorderable list of assembled slides or empty state prompt</li>
<li>Bottom: <strong>Export CTA Button</strong></li>
</ul>
</li>
</ul>
<h4 id="main-workspace---search-results-state">Main Workspace - Search Results State </h4>
<p><strong>When</strong>: After user types in Command Bar<br>
<strong>Layout</strong>:</p>
<ul>
<li><strong>Matching Slides</strong>: Remain at full opacity</li>
<li><strong>Non-Matching Slides</strong>: Fade to lower opacity (0.3) but stay in place</li>
<li><strong>Results Header</strong>: Above grid: "Showing 42 results for 'revenue charts'"</li>
</ul>
<h3 id="73-modal-specifications">7.3 Modal Specifications </h3>
<h4 id="prezis-visual-plan-modal">PrezI's Visual Plan Modal </h4>
<p><strong>When</strong>: Triggered by AI creation command<br>
<strong>Layout</strong>: Modal overlay dimming main workspace</p>
<ul>
<li><strong>Header</strong>: PrezI Avatar icon + Title (H4): "Here's My Plan"</li>
<li><strong>Body</strong>: Numbered, vertical list of steps
<ul>
<li>Each step: <strong>Title</strong> (bold) + <strong>Details</strong> (secondary text)</li>
<li>Example: "<strong>1. Find Opening Hook</strong>" &gt; "Searching for high-impact title and agenda slides."</li>
</ul>
</li>
<li><strong>Footer</strong>:
<ul>
<li><strong>Primary CTA Button (Success)</strong>: "✅ Execute Plan"</li>
<li><strong>Secondary Button</strong>: "🔧 Modify" (future feature)</li>
<li><strong>Tertiary Link Button</strong>: "Cancel"</li>
</ul>
</li>
</ul>
<h4 id="export-options-modal">Export Options Modal </h4>
<p><strong>When</strong>: User clicks "Export"<br>
<strong>Layout</strong>: Simple, clean modal</p>
<ul>
<li><strong>Title (H4)</strong>: "Export Presentation"</li>
<li><strong>Form Fields</strong>:
<ul>
<li><strong>Filename</strong>: Text input, pre-filled suggestion (<code>Investor-Pitch-2025-06-07</code>)</li>
<li><strong>Location</strong>: File path input with "Browse..." button</li>
<li><strong>Format</strong>: Radio buttons/dropdown for <code>.pptx</code> (default) and <code>.pdf</code></li>
</ul>
</li>
<li><strong>Footer</strong>:
<ul>
<li><strong>Primary CTA Button</strong>: "Export Now"</li>
<li><strong>Secondary Button</strong>: "Cancel"</li>
</ul>
</li>
</ul>
<h3 id="74-progress-indicator-specifications">7.4 Progress Indicator Specifications </h3>
<h4 id="importexport-progress">Import/Export Progress </h4>
<p><strong>When</strong>: During long-running backend tasks<br>
<strong>Layout</strong>:</p>
<ul>
<li><strong>Non-intrusive overlay</strong> in bottom-right corner</li>
<li><strong>Progress bar</strong> in Status Bar</li>
<li><strong>Must not block</strong> user from continuing work</li>
</ul>
<h4 id="ai-execution-progress">AI Execution Progress </h4>
<p><strong>When</strong>: During PrezI plan execution<br>
<strong>Layout</strong>:</p>
<ul>
<li><strong>Prominent modal overlay</strong> (primary action user is waiting for)</li>
<li><strong>Step-list display</strong> same as Visual Plan</li>
<li><strong>Checkmarks appear</strong> next to completed steps in real-time</li>
<li><strong>"Emergency Stop" button</strong> always visible for user control</li>
</ul>
<h3 id="75-component-library-details">7.5 Component Library Details </h3>
<h4 id="animation-specifications">Animation Specifications </h4>
<table>
<thead>
<tr>
<th>Interaction</th>
<th>Animation Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Standard Transition</strong></td>
<td><code>transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1)</code></td>
</tr>
<tr>
<td><strong>Modal Appearance</strong></td>
<td>Fade in + scale 95%→100%, <code>opacity: 0→1</code>, Duration: 0.3s</td>
</tr>
<tr>
<td><strong>List Item Appearance</strong></td>
<td>Staggered upward fade based on item index</td>
</tr>
<tr>
<td><strong>Drag &amp; Drop</strong></td>
<td>Semi-transparent (opacity: 0.7), ghost follows cursor, drop zones glow</td>
</tr>
<tr>
<td><strong>Progress Bars</strong></td>
<td>Smooth width transitions, no instant jumps</td>
</tr>
</tbody>
</table>
<h4 id="interaction-states">Interaction States </h4>
<table>
<thead>
<tr>
<th>Component</th>
<th>Default</th>
<th>Hover</th>
<th>Pressed</th>
<th>Selected</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Slide Card</strong></td>
<td><code>bg: #2a2a2a, border: transparent</code></td>
<td><code>translateY(-4px), shadow: 0 10px 30px rgba(0,0,0,0.3)</code></td>
<td><code>translateY(-2px)</code></td>
<td><code>border: 2px solid #3b82f6</code></td>
</tr>
<tr>
<td><strong>Keyword Pill</strong></td>
<td><code>bg: #2a2a2a, rounded: 20px</code></td>
<td><code>translateX(4px), bg: #3a3a3a</code></td>
<td><code>bg: #1a1a1a</code></td>
<td><code>bg: #a855f7</code></td>
</tr>
<tr>
<td><strong>Command Bar</strong></td>
<td><code>bg: #2a2a2a, border: #3a3a3a</code></td>
<td><code>border: #a855f7, shadow: 0 0 0 3px rgba(168,85,247,0.2)</code></td>
<td>-</td>
<td>Focus ring</td>
</tr>
</tbody>
</table>
<h4 id="prezi-avatar-animation">PrezI Avatar Animation </h4>
<table>
<thead>
<tr>
<th>Element</th>
<th>Animation</th>
<th>Duration</th>
<th>Effect</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Avatar Core</strong></td>
<td><code>float-avatar</code></td>
<td>3s infinite</td>
<td>Subtle floating and rotation</td>
</tr>
<tr>
<td><strong>Inner Soul</strong></td>
<td><code>morph-hero</code></td>
<td>4s infinite</td>
<td>Morphs between blob shapes</td>
</tr>
<tr>
<td><strong>Particles</strong></td>
<td><code>particles-outward</code></td>
<td>2s on-demand</td>
<td>Animate outward when "thinking"</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="8-operations-manual">8. Operations Manual </h2>
<h3 id="81-complete-error-handling-dictionary-prezis-voice">8.1 Complete Error Handling Dictionary (PrezI's Voice) </h3>
<table>
<thead>
<tr>
<th>Error Code</th>
<th>Technical Reason</th>
<th>PrezI's User-Facing Message</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>INVALID_API_KEY</code></strong></td>
<td>OpenAI API returns 401 Unauthorized</td>
<td>"It seems my API key isn't quite right. Could you please double-check it in the Settings menu? I can't connect to my brain without it!"</td>
</tr>
<tr>
<td><strong><code>API_RATE_LIMIT</code></strong></td>
<td>OpenAI API returns 429 Rate Limit Exceeded</td>
<td>"Looks like we're thinking a bit too fast! The OpenAI servers have asked us to take a short breather. Let's try that again in a few moments."</td>
</tr>
<tr>
<td><strong><code>API_SERVER_ERROR</code></strong></td>
<td>OpenAI API returns 5xx error</td>
<td>"My apologies, but the OpenAI servers seem to be having a moment. This is likely temporary on their end. I'll be ready to try again as soon as they are."</td>
</tr>
<tr>
<td><strong><code>COM_AUTOMATION_FAILURE</code></strong></td>
<td>Python backend cannot connect to PowerPoint</td>
<td>"I can't seem to communicate with your PowerPoint application. Please make sure it's installed correctly and not currently stuck on another task."</td>
</tr>
<tr>
<td><strong><code>FILE_IMPORT_FAILED</code></strong></td>
<td>Specific .pptx file is corrupt/unreadable</td>
<td>"I had some trouble analyzing the file <code>[filename]</code>. It might be corrupted or in a format I don't quite understand. Shall I skip it and continue with the rest?"</td>
</tr>
<tr>
<td><strong><code>PLAN_EXECUTION_FAILURE</code></strong></td>
<td>AI plan step fails during execution</td>
<td>"I hit a snag while trying to <code>[step description]</code>. No worries at all. We can either try that step again, or I can modify the plan to work around it. What would you prefer?"</td>
</tr>
<tr>
<td><strong><code>NO_SEARCH_RESULTS</code></strong></td>
<td>Search query returns zero results</td>
<td>"I've searched your entire library, but couldn't find anything matching <code>[search_query]</code>. Perhaps we could try a different keyword, or I can help you import more relevant slides?"</td>
</tr>
<tr>
<td><strong><code>DATABASE_CORRUPTION</code></strong></td>
<td>SQLite file is corrupted or locked</td>
<td>"Something seems off with my memory. This usually means the database file got confused. Would you like me to try rebuilding it from your imported files?"</td>
</tr>
<tr>
<td><strong><code>NETWORK_TIMEOUT</code></strong></td>
<td>OpenAI API call times out</td>
<td>"The connection to my AI brain timed out. This often happens with slower connections. Should we try that again?"</td>
</tr>
<tr>
<td><strong><code>DISK_SPACE_LOW</code></strong></td>
<td>Insufficient disk space for operations</td>
<td>"We're running a bit low on disk space. I might need you to free up some room before we can continue importing or exporting presentations."</td>
</tr>
</tbody>
</table>
<h3 id="82-comprehensive-logging-strategy">8.2 Comprehensive Logging Strategy </h3>
<h4 id="log-file-structure">Log File Structure </h4>
<pre data-role="codeBlock" data-info="json" class="language-json json"><code><span class="token punctuation">{</span>
  <span class="token property">"timestamp"</span><span class="token operator">:</span> <span class="token string">"2025-06-07T14:30:05.123Z"</span><span class="token punctuation">,</span>
  <span class="token property">"level"</span><span class="token operator">:</span> <span class="token string">"INFO|WARN|ERROR|DEBUG"</span><span class="token punctuation">,</span>
  <span class="token property">"module"</span><span class="token operator">:</span> <span class="token string">"powerpoint_automator|prezi_agent|database_manager|api_server"</span><span class="token punctuation">,</span>
  <span class="token property">"message"</span><span class="token operator">:</span> <span class="token string">"Human-readable description"</span><span class="token punctuation">,</span>
  <span class="token property">"details"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"file"</span><span class="token operator">:</span> <span class="token string">"filename.pptx"</span><span class="token punctuation">,</span>
    <span class="token property">"slide_count"</span><span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span>
    <span class="token property">"processing_time_ms"</span><span class="token operator">:</span> <span class="token number">1534</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"user_context"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"project_id"</span><span class="token operator">:</span> <span class="token number">123</span><span class="token punctuation">,</span>
    <span class="token property">"session_id"</span><span class="token operator">:</span> <span class="token string">"uuid-string"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><h4 id="critical-events-to-log">Critical Events to Log </h4>
<ol>
<li>
<p><strong>Application Lifecycle</strong>:</p>
<ul>
<li>Startup, shutdown, crash recovery</li>
<li>Module initialization and health checks</li>
<li>Configuration loading and validation</li>
</ul>
</li>
<li>
<p><strong>User Operations</strong>:</p>
<ul>
<li>Project creation, loading, switching</li>
<li>File import start/progress/completion</li>
<li>Search queries and result counts</li>
<li>Assembly operations and export requests</li>
</ul>
</li>
<li>
<p><strong>AI Interactions</strong>:</p>
<ul>
<li>OpenAI API request parameters (masked API key)</li>
<li>Response processing and parsing</li>
<li>Plan generation and execution steps</li>
<li>Error conditions and retry attempts</li>
</ul>
</li>
<li>
<p><strong>System Health</strong>:</p>
<ul>
<li>Database operations and performance</li>
<li>COM automation status and errors</li>
<li>Memory usage and performance metrics</li>
<li>Network connectivity and API quotas</li>
</ul>
</li>
</ol>
<h4 id="log-rotation-and-retention">Log Rotation and Retention </h4>
<ul>
<li><strong>Location</strong>: <code>%APPDATA%/PrezI/logs/</code></li>
<li><strong>Format</strong>: <code>prezi_YYYY-MM-DD.log</code></li>
<li><strong>Retention</strong>: 7 days (automatic cleanup)</li>
<li><strong>Max Size</strong>: 10MB per file (rotate if exceeded)</li>
<li><strong>Compression</strong>: Older logs compressed to save space</li>
</ul>
<h3 id="83-security-protocols">8.3 Security Protocols </h3>
<h4 id="api-key-management-windows-first">API Key Management (Windows-First) </h4>
<pre data-role="codeBlock" data-info="python" class="language-python python"><code><span class="token comment"># Secure storage implementation</span>
<span class="token keyword keyword-import">import</span> keyring

<span class="token keyword keyword-def">def</span> <span class="token function">store_api_key</span><span class="token punctuation">(</span>api_key<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">bool</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Store API key in Windows Credential Manager"""</span>
    <span class="token keyword keyword-try">try</span><span class="token punctuation">:</span>
        keyring<span class="token punctuation">.</span>set_password<span class="token punctuation">(</span><span class="token string">"PrezI"</span><span class="token punctuation">,</span> <span class="token string">"openai_api_key"</span><span class="token punctuation">,</span> api_key<span class="token punctuation">)</span>
        <span class="token keyword keyword-return">return</span> <span class="token boolean">True</span>
    <span class="token keyword keyword-except">except</span> Exception <span class="token keyword keyword-as">as</span> e<span class="token punctuation">:</span>
        logger<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Failed to store API key: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword keyword-return">return</span> <span class="token boolean">False</span>

<span class="token keyword keyword-def">def</span> <span class="token function">retrieve_api_key</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Retrieve API key from secure storage"""</span>
    <span class="token keyword keyword-try">try</span><span class="token punctuation">:</span>
        <span class="token keyword keyword-return">return</span> keyring<span class="token punctuation">.</span>get_password<span class="token punctuation">(</span><span class="token string">"PrezI"</span><span class="token punctuation">,</span> <span class="token string">"openai_api_key"</span><span class="token punctuation">)</span>
    <span class="token keyword keyword-except">except</span> Exception <span class="token keyword keyword-as">as</span> e<span class="token punctuation">:</span>
        logger<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Failed to retrieve API key: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword keyword-return">return</span> <span class="token boolean">None</span>
</code></pre><h4 id="data-privacy-safeguards">Data Privacy Safeguards </h4>
<ul>
<li><strong>Local-First Architecture</strong>: All user data remains on local machine</li>
<li><strong>No Cloud Sync</strong>: Project files never transmitted to external servers</li>
<li><strong>API Key Encryption</strong>: Stored using OS-native credential managers</li>
<li><strong>Minimal API Payloads</strong>: Only essential text sent to OpenAI, never full slides</li>
<li><strong>User Consent</strong>: Clear disclosure of what data is sent to AI services</li>
</ul>
<h3 id="84-configuration-management-system">8.4 Configuration Management System </h3>
<h4 id="application-settings-schema">Application Settings Schema </h4>
<pre data-role="codeBlock" data-info="json" class="language-json json"><code><span class="token punctuation">{</span>
  <span class="token property">"user_preferences"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"default_project_directory"</span><span class="token operator">:</span> <span class="token string">"C:/Users/Name/Documents/PrezI Projects"</span><span class="token punctuation">,</span>
    <span class="token property">"prezi_personality"</span><span class="token operator">:</span> <span class="token string">"Professional &amp; Witty|Formal &amp; Concise"</span><span class="token punctuation">,</span>
    <span class="token property">"export_format_default"</span><span class="token operator">:</span> <span class="token string">"pptx|pdf"</span><span class="token punctuation">,</span>
    <span class="token property">"auto_open_exports"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"command_bar_placeholder_cycling"</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"performance_settings"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"thumbnail_quality"</span><span class="token operator">:</span> <span class="token string">"high|medium|low"</span><span class="token punctuation">,</span>
    <span class="token property">"background_processing_threads"</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
    <span class="token property">"cache_size_mb"</span><span class="token operator">:</span> <span class="token number">512</span><span class="token punctuation">,</span>
    <span class="token property">"auto_cleanup_temp_files"</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"ai_settings"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"openai_model_preference"</span><span class="token operator">:</span> <span class="token string">"gpt-4o|gpt-4o-mini"</span><span class="token punctuation">,</span>
    <span class="token property">"response_timeout_seconds"</span><span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span>
    <span class="token property">"retry_attempts"</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token property">"confidence_threshold"</span><span class="token operator">:</span> <span class="token number">0.75</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"onboarding_state"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"completed"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"last_version"</span><span class="token operator">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span>
    <span class="token property">"skip_tips"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">"preferred_learning_path"</span><span class="token operator">:</span> <span class="token string">"feature_first|import_first"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><h4 id="settings-ui-implementation">Settings UI Implementation </h4>
<ul>
<li><strong>Location</strong>: Gear icon in main window header</li>
<li><strong>Organization</strong>: Tabbed interface (General, Performance, AI, Privacy)</li>
<li><strong>Validation</strong>: Real-time feedback on setting changes</li>
<li><strong>Reset Options</strong>: "Restore Defaults" for each category</li>
<li><strong>Export/Import</strong>: Settings backup and restore for power users</li>
</ul>
<h3 id="85-onboarding-state-machine-complete-implementation">8.5 Onboarding State Machine (Complete Implementation) </h3>
<h4 id="state-definitions-with-transitions">State Definitions with Transitions </h4>
<pre data-role="codeBlock" data-info="python" class="language-python python"><code><span class="token keyword keyword-class">class</span> <span class="token class-name">OnboardingState</span><span class="token punctuation">(</span>Enum<span class="token punctuation">)</span><span class="token punctuation">:</span>
    WELCOME <span class="token operator">=</span> <span class="token number">1</span>           <span class="token comment"># Initial greeting and overview</span>
    API_SETUP <span class="token operator">=</span> <span class="token number">2</span>         <span class="token comment"># OpenAI API key configuration</span>
    BRANCH_CHOICE <span class="token operator">=</span> <span class="token number">3</span>     <span class="token comment"># Choose learning path</span>
    FEATURE_TOUR <span class="token operator">=</span> <span class="token number">4</span>      <span class="token comment"># Overview of key features</span>
    IMPORT_FIRST <span class="token operator">=</span> <span class="token number">5</span>      <span class="token comment"># Hands-on import experience</span>
    COMMAND_BAR <span class="token operator">=</span> <span class="token number">6</span>       <span class="token comment"># Natural language search tutorial</span>
    ASSEMBLY_PANEL <span class="token operator">=</span> <span class="token number">7</span>    <span class="token comment"># Presentation building tutorial</span>
    AI_ASSISTANT <span class="token operator">=</span> <span class="token number">8</span>      <span class="token comment"># AI capabilities demonstration</span>
    GRADUATION <span class="token operator">=</span> <span class="token number">9</span>        <span class="token comment"># Completion and next steps</span>
    COMPLETED <span class="token operator">=</span> <span class="token number">10</span>        <span class="token comment"># Terminal state</span>

<span class="token comment"># Valid transitions matrix</span>
VALID_TRANSITIONS <span class="token operator">=</span> <span class="token punctuation">{</span>
    WELCOME<span class="token punctuation">:</span> <span class="token punctuation">[</span>API_SETUP<span class="token punctuation">]</span><span class="token punctuation">,</span>
    API_SETUP<span class="token punctuation">:</span> <span class="token punctuation">[</span>BRANCH_CHOICE<span class="token punctuation">]</span><span class="token punctuation">,</span>
    BRANCH_CHOICE<span class="token punctuation">:</span> <span class="token punctuation">[</span>FEATURE_TOUR<span class="token punctuation">,</span> IMPORT_FIRST<span class="token punctuation">]</span><span class="token punctuation">,</span>
    FEATURE_TOUR<span class="token punctuation">:</span> <span class="token punctuation">[</span>COMMAND_BAR<span class="token punctuation">,</span> IMPORT_FIRST<span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment"># Allow path switching</span>
    IMPORT_FIRST<span class="token punctuation">:</span> <span class="token punctuation">[</span>ASSEMBLY_PANEL<span class="token punctuation">,</span> FEATURE_TOUR<span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment"># Allow path switching</span>
    COMMAND_BAR<span class="token punctuation">:</span> <span class="token punctuation">[</span>ASSEMBLY_PANEL<span class="token punctuation">]</span><span class="token punctuation">,</span>
    ASSEMBLY_PANEL<span class="token punctuation">:</span> <span class="token punctuation">[</span>AI_ASSISTANT<span class="token punctuation">]</span><span class="token punctuation">,</span>
    AI_ASSISTANT<span class="token punctuation">:</span> <span class="token punctuation">[</span>GRADUATION<span class="token punctuation">]</span><span class="token punctuation">,</span>
    GRADUATION<span class="token punctuation">:</span> <span class="token punctuation">[</span>COMPLETED<span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment"># Special transitions</span>
    <span class="token string">"*"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>COMPLETED<span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment"># Skip to end from any state</span>
<span class="token punctuation">}</span>
</code></pre><h4 id="analytics-tracking-schema">Analytics Tracking Schema </h4>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token comment">-- Onboarding completion analytics</span>
<span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> onboarding_analytics <span class="token keyword keyword-AS">AS</span>
<span class="token keyword keyword-SELECT">SELECT</span> 
    onboarding_id<span class="token punctuation">,</span>
    started_at<span class="token punctuation">,</span>
    completed_at<span class="token punctuation">,</span>
    JULIANDAY<span class="token punctuation">(</span>completed_at<span class="token punctuation">)</span> <span class="token operator">-</span> JULIANDAY<span class="token punctuation">(</span>started_at<span class="token punctuation">)</span> <span class="token keyword keyword-as">as</span> days_to_complete<span class="token punctuation">,</span>
    branch_path<span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token keyword keyword-SELECT">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword keyword-FROM">FROM</span> onboarding_transitions 
     <span class="token keyword keyword-WHERE">WHERE</span> onboarding_id <span class="token operator">=</span> o<span class="token punctuation">.</span>onboarding_id<span class="token punctuation">)</span> <span class="token keyword keyword-as">as</span> total_transitions<span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token keyword keyword-SELECT">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword keyword-FROM">FROM</span> onboarding_actions 
     <span class="token keyword keyword-WHERE">WHERE</span> onboarding_id <span class="token operator">=</span> o<span class="token punctuation">.</span>onboarding_id 
     <span class="token operator">AND</span> action_type <span class="token operator">=</span> <span class="token string">'difficulty'</span><span class="token punctuation">)</span> <span class="token keyword keyword-as">as</span> difficulty_signals
<span class="token keyword keyword-FROM">FROM</span> onboarding_state o
<span class="token keyword keyword-WHERE">WHERE</span> completed <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre><hr>
<h2 id="9-enhancement-roadmap">9. Enhancement Roadmap </h2>
<h3 id="91-likeable--appealing-features">9.1 Likeable &amp; Appealing Features </h3>
<ul>
<li><strong>Instant Brand-Snap</strong>: One-click corporate color/font import from sample slides</li>
<li><strong>Smart Template Marketplace</strong>: Community-contributed slide styles (VS Code theme model)</li>
<li><strong>Live Thumbnail Preview</strong>: Real-time AI generation preview with cancel/redo options</li>
</ul>
<h3 id="92-quality-of-life-improvements">9.2 Quality-of-Life Improvements </h3>
<ul>
<li><strong>Projects &amp; Collections</strong>: Named slide sets with bulk export capabilities</li>
<li><strong>PowerShot</strong>: Alt+P global hotkey for clipboard-to-slide generation</li>
<li><strong>Guided Variations</strong>: Quick "More Minimal/Visual/Data-Heavy" iteration buttons</li>
<li><strong>Rich Undo/Redo</strong>: Cross-AI and manual edit operation history</li>
</ul>
<h3 id="93-dependability--trust-features">9.3 Dependability &amp; Trust Features </h3>
<ul>
<li><strong>Crash-Safe Draft Cache</strong>: SQLite journal with recovery on restart</li>
<li><strong>Offline Fallback Mode</strong>: Local small-model for basic operations</li>
<li><strong>Telemetry Transparency</strong>: Clear data usage visibility for enterprise adoption</li>
<li><strong>Accessibility Linter</strong>: Color contrast and alt-text validation</li>
</ul>
<h3 id="94-growth--feedback-loops">9.4 Growth &amp; Feedback Loops </h3>
<ul>
<li><strong>In-App Rating System</strong>: One-tap slide helpfulness feedback for fine-tuning</li>
<li><strong>Share-a-Link Review</strong>: Web preview links for stakeholder approval</li>
<li><strong>Community Template Sharing</strong>: User-contributed style ecosystem</li>
</ul>
<h3 id="95-implementation-strategy">9.5 Implementation Strategy </h3>
<ul>
<li>Leverage existing state machine for new features</li>
<li>Use feature flags for beta testing capabilities</li>
<li>Bundle hotkey listener in Electron shell</li>
<li>Pick 3-4 easy/medium items per sprint for continuous wow factor</li>
</ul>
<hr>
<h2 id="10-quick-reference">10. Quick Reference </h2>
<h3 id="101-key-commands--shortcuts">10.1 Key Commands &amp; Shortcuts </h3>
<ul>
<li><strong>Global Import</strong>: Drag &amp; drop .pptx files anywhere</li>
<li><strong>Search</strong>: Type in command bar for instant filtering</li>
<li><strong>Assemble</strong>: Drag slides to right panel</li>
<li><strong>AI Create</strong>: "Create [presentation type]" in command bar</li>
<li><strong>Export</strong>: Click Export button in assembly panel</li>
</ul>
<h3 id="102-file-locations">10.2 File Locations </h3>
<ul>
<li><strong>Database</strong>: <code>%APPDATA%/PrezI/projects.db</code></li>
<li><strong>Logs</strong>: <code>%APPDATA%/PrezI/logs/prezi_YYYY-MM-DD.log</code></li>
<li><strong>Thumbnails</strong>: <code>%APPDATA%/Local/PrezI/thumbnails/</code></li>
<li><strong>Projects</strong>: User-selected directory structure</li>
</ul>
<h3 id="103-development-commands">10.3 Development Commands </h3>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code><span class="token comment"># Backend setup</span>
<span class="token builtin class-name">cd</span> backend
pip <span class="token function">install</span> <span class="token parameter variable">-r</span> requirements.txt
python main.py

<span class="token comment"># Frontend setup</span>
<span class="token builtin class-name">cd</span> frontend
<span class="token comment"># Served by backend FastAPI static files</span>

<span class="token comment"># Full application</span>
<span class="token function">npm</span> start  <span class="token comment"># Launches Electron with backend</span>
<span class="token function">npm</span> <span class="token builtin class-name">test</span>   <span class="token comment"># Runs complete test suite</span>
<span class="token function">npm</span> run build  <span class="token comment"># Creates distribution package</span>
</code></pre><h3 id="104-api-quick-reference">10.4 API Quick Reference </h3>
<ul>
<li><strong>Search</strong>: <code>GET /api/v1/slides?search=query</code></li>
<li><strong>Import</strong>: <code>POST /api/v1/projects/{id}/import</code></li>
<li><strong>AI Plan</strong>: <code>POST /api/v1/prezi/interpret → /prezi/plan</code></li>
<li><strong>Export</strong>: <code>POST /api/v1/export</code></li>
<li><strong>WebSocket</strong>: <code>ws://127.0.0.1:8765/ws</code> for real-time updates</li>
</ul>
<h3 id="105-troubleshooting-checklist">10.5 Troubleshooting Checklist </h3>
<ol>
<li><strong>PowerPoint installed and accessible?</strong></li>
<li><strong>OpenAI API key valid and funded?</strong></li>
<li><strong>Local port 8765 available?</strong></li>
<li><strong>Database file permissions correct?</strong></li>
<li><strong>Log files show recent activity?</strong></li>
</ol>
<hr>
<p><em>This consolidated document represents the complete knowledge base for the PrezI project, synthesized from 13 individual specification documents. It serves as the single source of truth for vision, architecture, design, development, and operations.</em></p>
<p><strong>Document Sources:</strong></p>
<ul>
<li><a href="http://AIDD.md">AIDD.md</a>, API_SPEC.md, DB_SCHEMA.md, Dev_Test_Plan.md, <a href="http://OPEXP.md">OPEXP.md</a></li>
<li>Onboarding_State_Machine.md, <a href="http://PRD.md">PRD.md</a>, <a href="http://SAD.md">SAD.md</a>, <a href="http://UXUID.md">UXUID.md</a></li>
<li>fnf_checklist.md, o3_extras.md, project_layout.md, wireframe_userflow.md</li>
</ul>
<p><strong>Last Updated:</strong> June 8, 2025<br>
<strong>Status:</strong> Complete Master Reference - All Source Content Verified and Integrated<br>
<strong>Verification:</strong> Comprehensive audit completed - All 13 source documents fully represented</p>

      </div>
      
      
    
    
    <script type="module">
// TODO: If ZenUML gets integrated into mermaid in the future,
//      we can remove the following lines.


var MERMAID_CONFIG = ({"startOnLoad":false});
if (typeof MERMAID_CONFIG !== 'undefined') {
  MERMAID_CONFIG.startOnLoad = false
  MERMAID_CONFIG.cloneCssStyles = false
  MERMAID_CONFIG.theme = "default"
}

mermaid.initialize(MERMAID_CONFIG || {})
if (typeof(window['Reveal']) !== 'undefined') {
  function mermaidRevealHelper(event) {
    var currentSlide = event.currentSlide
    var diagrams = currentSlide.querySelectorAll('.mermaid')
    for (var i = 0; i < diagrams.length; i++) {
      var diagram = diagrams[i]
      if (!diagram.hasAttribute('data-processed')) {
        mermaid.init(null, diagram, ()=> {
          Reveal.slide(event.indexh, event.indexv)
        })
      }
    }
  }
  Reveal.addEventListener('slidetransitionend', mermaidRevealHelper)
  Reveal.addEventListener('ready', mermaidRevealHelper)
  await mermaid.run({
    nodes: document.querySelectorAll('.mermaid')
  })
} else {
  await mermaid.run({
    nodes: document.querySelectorAll('.mermaid')
  })
}
</script>
    
    
    
  
    </body></html>